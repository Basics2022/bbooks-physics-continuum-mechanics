%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Continuum Mechanics}}

\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{continuum mechanics}
\date{Sep 02, 2025}
\release{}
\author{basics}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{intro::doc}}


\sphinxAtStartPar
This material is part of the \sphinxhref{https://basics2022.github.io/bbooks}{\sphinxstylestrong{basics\sphinxhyphen{}books project}}. It is also available as a \DUrole{xref,download,myst}{.pdf document}.

\sphinxAtStartPar
\sphinxstylestrong{work\sphinxhyphen{}in\sphinxhyphen{}progress! Feel free to reach out on Github, leave a comment, a suggestion, a request or contribute}

\sphinxAtStartPar
General approach and equations in continuum mechanics are first presented, and then specialized to the most common models of solids \sphinxhyphen{} mainly elastic solids \sphinxhyphen{} and fluids \sphinxhyphen{} mainly Newtonian fluids.
\subsubsection*{Introduction to Continuum Mechanics}

\sphinxAtStartPar
\sphinxstylestrong{Kinematics of continuum media.} Lagrangian, Eulerian and arbitrary descriptions of the motion of continuous media is presented, and kinematic quantities are introduced.

\sphinxAtStartPar
\sphinxstylestrong{Balance equations of physical quantities.} Balance equations of physical quantities are introduced here for continuous media, both in integral and differential forms \sphinxhyphen{} in regular domains with “smooth” distribution of physical properties. Reynolds theorem and derivatives of composite functions are exploited to provide Lagrangian, Eulerian and arbitrary descriptions \sphinxhyphen{} and their relationship \sphinxhyphen{} both for integral and differential equations respectively.

\sphinxAtStartPar
First Lavoisier principle for mass conservation, Newton principles and equations of motion for momentum and angular momentu balance equation, and first principle of thermodynamics or balance equation of total energy are written for closed systems \sphinxhyphen{} and derived for arbitrary systems.

\sphinxAtStartPar
The need for constitutive equations and state equations is discussed. Properties of stress tensors and heat conduction flux are described.

\sphinxAtStartPar
Then, balance equations for other physical quantities are derived, e.g. for kinetic energy, internal energy, and entropy. Balance equation of entropy and second principle of thermodynamics prescribe some constraints on stress tensor and heat conduction flux.
\subsubsection*{Solid Mechanics}
\subsubsection*{Fluid Mechanics}



\sphinxstepscope


\part{Continuum Mechanics}

\sphinxstepscope


\chapter{Kinematics}
\label{\detokenize{ch/continuum/kinematics:kinematics}}\label{\detokenize{ch/continuum/kinematics:continuum-kinematics}}\label{\detokenize{ch/continuum/kinematics::doc}}
\sphinxAtStartPar
Let
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\vec{r}\) the physical space coordinates

\item {} 
\sphinxAtStartPar
\(\vec{r}_0\) the material coordinates, labels associated to material points of the continuum

\item {} 
\sphinxAtStartPar
\(\vec{r}_b\) arbitrary coordinates, labels associated to arbitrary points \sphinxhyphen{} e.g. geometric points

\end{itemize}


\section{Material points in physical space}
\label{\detokenize{ch/continuum/kinematics:material-points-in-physical-space}}\label{\detokenize{ch/continuum/kinematics:continuum-kinematics-material-points}}
\sphinxAtStartPar
\sphinxstylestrong{Position.} The position in physical space of material points labeled with material coordinates \(\vec{r}_0\) can be written as a function
\begin{equation}\label{equation:ch/continuum/kinematics:eq:r:r0-t}
\begin{split}\vec{r}(\vec{r}_0, t) \ ,\end{split}
\end{equation}
\sphinxAtStartPar
providing the position in physical space of a material point, as a function of its label \(\vec{r}_0\) and time \(t\).

\sphinxAtStartPar
\sphinxstylestrong{Velocity.} The velocity of each material point is the time\sphinxhyphen{}derivative of function \eqref{equation:ch/continuum/kinematics:eq:r:r0-t} at constant \(\vec{r}_0\) (since one is interested here in the velocity of material points),
\begin{equation}\label{equation:ch/continuum/kinematics:eq:vel}
\begin{split}\vec{u} = \left.\dfrac{\partial \vec{r}}{\partial t}\right|_{\vec{r}_0} =: \dfrac{D \vec{r}}{D t} \ ,\end{split}
\end{equation}
\sphinxAtStartPar
having introduced the definition of \sphinxstylestrong{material derivative}, \(\dfrac{D}{Dt} := \left.\dfrac{\partial}{\partial t}\right|_{\vec{r}_0}\).

\begin{sphinxadmonition}{note}{Independent variables}

\sphinxAtStartPar
In formula \eqref{equation:ch/continuum/kinematics:eq:vel}, independent variables are not explicitly written. If \(\vec{r}\left(\vec{r}_0, t\right)\), the velocity field \(\vec{u}\) can be readily written as functions of the same independent variables,
\begin{equation*}
\begin{split}\vec{u}_0\left( \vec{r}_0, t\right) = \left.\dfrac{\partial \vec{r}}{\partial t}\right|_{\vec{r}_0}(\vec{r}_0, t) \ , \end{split}
\end{equation*}
\sphinxAtStartPar
and it provides the velocity field as a function of the material coordinates, namely the \sphinxstylestrong{Lagrangian description}, following material points in their evolution in space.

\sphinxAtStartPar
Eulerian description of the problem requires physical properties to be written as functions of physical coordinates, \(\vec{r}\), \(t\). If the inverse transformation of \eqref{equation:ch/continuum/kinematics:eq:r:r0-t} exists, it’s possible to write \(\vec{r}_0\left(\vec{r}, t\right)\), and the velocity field as
\begin{equation*}
\begin{split}\vec{u}\left( \vec{r}, t\right) = \vec{u}_0\left( \vec{r}_0\left(\vec{r}, t\right), t\right) \ , \end{split}
\end{equation*}
\sphinxAtStartPar
or, for invertible transformations,
\begin{equation*}
\begin{split}\vec{u}_0\left( \vec{r}_0, t\right) = \vec{u}\left( \vec{r}\left(\vec{r}_0, t\right), t\right) \ , \end{split}
\end{equation*}
\sphinxAtStartPar
having used indices to mathematcally discern functions of different independent variables, even if they represent the same phsyical quantity. In many situations, this inverse transformation between the position in physical space and the material coordinates is not well\sphinxhyphen{}defined, often for fluid systems or solid mechanics with (very) large deformations: in these cases, it’s always (?) possible to update the reference configuration at some closer time instant in order to find a well\sphinxhyphen{}defined inverse transformation, if needed.
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{Acceleration.} Acceleration of a material point labeled with material coordinate \(\vec{r}_0\) is the second order derivative of the physical position \eqref{equation:ch/continuum/kinematics:eq:r:r0-t} w.r.t. time \(t\) keeping \(\vec{r}_0\) constant, or the first order derivative of the velocity \eqref{equation:ch/continuum/kinematics:eq:vel},
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{a} = \left.\frac{\partial \vec{u}}{\partial t}\right|_{\vec{r}_0}
   & = \left.\frac{\partial \vec{r}}{\partial t}\right|_{\vec{r}_0} \cdot \left.\dfrac{\partial \vec{u}}{\partial \vec{r}}\right|_{t} + \left.\dfrac{\partial \vec{u}}{\partial t}\right|_{\vec{r}}   
     = \vec{u} \cdot \nabla \vec{u} + \dfrac{\partial \vec{u}}{\partial t} \ , 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having written the partial derivative in time at constant physical coordianate \(\vec{r}\) as \(\left.\dfrac{\partial }{\partial t}\right|_{\vec{r}} = \dfrac{\partial}{\partial t}\), and the gradient w.r.t. the physical coordinate as \(\nabla_{\vec{r}} = \nabla\).


\section{Arbitrary points in physical space}
\label{\detokenize{ch/continuum/kinematics:arbitrary-points-in-physical-space}}\label{\detokenize{ch/continuum/kinematics:continuum-kinematics-arbitrary-points}}
\sphinxAtStartPar
Following the same process as the one used for {\hyperref[\detokenize{ch/continuum/kinematics:continuum-kinematics-material-points}]{\sphinxcrossref{\DUrole{std,std-ref}{material points}}}}, the position, the velocity and the acceleration of a set of arbitrary points labeled with \(\vec{r}_b\) coordinates read
\begin{equation*}
\begin{split}\begin{aligned}
  & \vec{r}\left( \vec{r}_b, t \right) \\
  \vec{u}_b = & \left.\frac{\partial \vec{r}}{\partial t}\right|_{\vec{r}_b} \\
  \vec{a}_b = & \left.\frac{\partial \vec{u}_b}{\partial t}\right|_{\vec{r}_b} = \frac{\partial \vec{u}_b}{\partial t} + \vec{u}_b \cdot \nabla \vec{u}_b
\end{aligned}\end{split}
\end{equation*}

\section{Time derivatives of a function from different descriptions}
\label{\detokenize{ch/continuum/kinematics:time-derivatives-of-a-function-from-different-descriptions}}\label{\detokenize{ch/continuum/kinematics:continuum-kinematics-function-derivatives}}
\sphinxAtStartPar
Coordinate transformations implies the rules to compute the relations between time derivatives of a field \(f\) keeping physical, material or arbitrary coordinates constant, namely
\begin{equation*}
\begin{split}\begin{aligned}
\dfrac{\partial}{\partial t}\bigg|_{\vec{r}_0} f(\vec{r}(\vec{r}_0, t), t) 
    = \dfrac{\partial f}{\partial t}\bigg|_{\vec{r}} +
    \dfrac{\partial \vec{r}}{\partial t}\bigg|_{\vec{r}_0} \cdot \dfrac{\partial f}{\partial \vec{r}}\bigg|_{t} 
    = \dfrac{\partial f}{\partial t}\bigg|_{\vec{r}} +
      \vec{u} \cdot \nabla f 
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
\dfrac{\partial}{\partial t}\bigg|_{\vec{r}_b} f(\vec{r}(\vec{r}_b, t), t) 
    = \dfrac{\partial f}{\partial t}\bigg|_{\vec{r}} +
    \dfrac{\partial \vec{r}}{\partial t}\bigg|_{\vec{r}_b} \cdot \dfrac{\partial f}{\partial \vec{r}}\bigg|_{t} 
    = \dfrac{\partial f}{\partial t}\bigg|_{\vec{r}} +
      \vec{u}_b \cdot \nabla f 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus
\begin{equation}\label{equation:ch/continuum/kinematics:eq:field-time-derivatives}
\begin{split}
\dfrac{D f}{D t} = \dfrac{\partial}{\partial t}\bigg|_{\vec{r}_0} f =  
\dfrac{\partial}{\partial t}\bigg|_{\vec{r}  } f + \vec{u} \cdot \nabla f =  
\dfrac{\partial}{\partial t}\bigg|_{\vec{r}_b} f + ( \vec{u} - \vec{u}_b ) \cdot \nabla f \ . 
\end{split}
\end{equation}

\section{Kinematics of two points}
\label{\detokenize{ch/continuum/kinematics:kinematics-of-two-points}}\label{\detokenize{ch/continuum/kinematics:kinematics-two-points}}\begin{equation*}
\begin{split}\vec{r}_2(t) - \vec{r}_1(t) = \vec{r}\left(\vec{r}_{0,2}, t \right) - \vec{r}\left(\vec{r}_{0,1}, t \right)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\vec{v}_2(t) - \vec{v}_1(t) = \dfrac{d}{dt} \vec{r}_2(t) - \dfrac{d}{dt} \vec{r}_1(t)\end{split}
\end{equation*}
\sphinxAtStartPar
strain velocity tensor
\begin{equation}\label{equation:ch/continuum/kinematics:eq:strain-vel-tensor}
\begin{split}\mathbb{D} = \frac{1}{2} \left[ \nabla \vec{u} + \nabla^T \vec{u} \right]\end{split}
\end{equation}

\section{Kinematics in reference space}
\label{\detokenize{ch/continuum/kinematics:kinematics-in-reference-space}}\label{\detokenize{ch/continuum/kinematics:kinematics-reference-space}}
\sphinxAtStartPar
Let \(\vec{r}(\vec{r}_0, t)\), it’s differential \sphinxhyphen{} keeping \(t\) constant \sphinxhyphen{} reads
\begin{equation*}
\begin{split}d \vec{r} = d \vec{r}_0 \cdot \nabla_0 \vec{r} = d \vec{r}_0 \cdot \mathbb{F}\end{split}
\end{equation*}
\sphinxAtStartPar
or using a Cartesian base in the reference space
\begin{equation*}
\begin{split}d \vec{r} = \hat{e}^0_i d x^0_k \dfrac{\partial x_i}{\partial x^0_k}  = \hat{e}^0_i \, d x^0_k \, F_{ki} = \hat{e}^0_i \, d x_i \ .\end{split}
\end{equation*}\begin{equation*}
\begin{split}|d \vec{r}|^2 = d \vec{r} \cdot d \vec{r} = d \vec{r}_0 \cdot \mathbb{F} \cdot \mathbb{F}^T \cdot d \vec{r}_0 \end{split}
\end{equation*}\begin{equation*}
\begin{split}|d \vec{r}|^2 - |d \vec{r}_0|^2 = d \vec{r}_0 \cdot \left[ \mathbb{F} \cdot \mathbb{F}^T - \mathbb{I} \right] \cdot d \vec{r}_0 \end{split}
\end{equation*}

\subsection{Strain}
\label{\detokenize{ch/continuum/kinematics:strain}}\label{\detokenize{ch/continuum/kinematics:kinematics-reference-space-strain}}

\subsubsection{Green\sphinxhyphen{}Lagrange tensor}
\label{\detokenize{ch/continuum/kinematics:green-lagrange-tensor}}\label{\detokenize{ch/continuum/kinematics:kinematics-reference-space-strain-green-lagrange}}
\sphinxAtStartPar
\sphinxstylestrong{Green\sphinxhyphen{}Lagrange strain tensor} is defined as
\begin{equation}\label{equation:ch/continuum/kinematics:eq:green-lagrange}
\begin{split}\mathbb{\epsilon} := \frac{1}{2} \left[ \mathbb{F} \cdot \mathbb{F}^T - \mathbb{I} \right]\end{split}
\end{equation}
\sphinxAtStartPar
or in Cartesian coordinates in the reference space
\begin{equation*}
\begin{split}\begin{aligned}
  \epsilon_{ij} 
  & = \frac{1}{2} \left[ F_{ik} F_{jk} - \delta_{ij} \right] 
    = \frac{1}{2} \left[ \dfrac{\partial x_i}{\partial x^0_k} \, \dfrac{\partial x_j}{\partial x^0_k} - \delta_{ij} \right]  \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Its (material) time derivative reads (\sphinxstylestrong{todo} \sphinxstyleemphasis{pay attention to vector basis in reference and physical space. Can they be compared/confused?})
\begin{equation*}
\begin{split}\begin{aligned}
  \dfrac{D \epsilon_{ij}}{D t}
  & = \dfrac{1}{2} \left[ \dfrac{D}{Dt}\dfrac{\partial x_k}{\partial x_i^0} \frac{\partial x_k}{\partial x^0_j} + \frac{\partial x_k}{\partial x^0_i} \dfrac{D}{Dt} \frac{\partial x_k}{\partial x^0_j}  \right] = \\
  & = \dfrac{1}{2} \left[ \dfrac{\partial v_k}{\partial x_i^0} \frac{\partial x_k}{\partial x^0_j} + \frac{\partial x_k}{\partial x^0_i}  \frac{\partial v_k}{\partial x^0_j}  \right] = \\
  & = \dfrac{1}{2} \left[ \dfrac{\partial x_l}{\partial x^0_i} \dfrac{\partial v_k}{\partial x_l} \frac{\partial x_k}{\partial x^0_j} + \frac{\partial x_k}{\partial x^0_i} \frac{\partial x_l}{\partial x^0_j} \frac{\partial v_k}{\partial x^l}  \right]  \\
  & = \dfrac{\partial x_l}{\partial x^0_i} \left[ \frac{1}{2} \left( \dfrac{\partial v_k}{\partial x_l} + \frac{\partial v_l}{\partial x^k} \right) \right] \dfrac{\partial x_k}{\partial x^0_j} = \\
  & = F_{il} \, D_{lk} \, F_{jk} \ .
\end{aligned}\end{split}
\end{equation*}\begin{equation}\label{equation:ch/continuum/kinematics:eq:green-lagrange:dt}
\begin{split}\begin{aligned}
 \dfrac{D \mathbb{\epsilon}}{Dt} 
 & = \dfrac{1}{2} \left[ \dfrac{D \mathbb{F}}{D t} \cdot \mathbb{F}^T + \mathbb{F} \cdot \frac{D \mathbb{F}^T}{D t} \right] = \\
 & = \dfrac{1}{2} \left[ \, \nabla_0 \vec{v} \cdot \mathbb{F}^T + \mathbb{F} \cdot \nabla_0^T \vec{v} \, \right] = \\
 & = \dfrac{1}{2} \left[ \, \mathbb{F} \cdot \nabla \vec{v} \cdot \mathbb{F}^T + \mathbb{F} \cdot \nabla^T \vec{v} \cdot \mathbb{F}^T \, \right] = \\
 & = \mathbb{F} \cdot \left[ \, \dfrac{1}{2} \left( \, \nabla \vec{v} + \nabla^T \vec{v} \, \right) \, \right] \cdot \mathbb{F}^T = \\
 & = \mathbb{F} \cdot \mathbb{D} \cdot \mathbb{F}^T \ .
\end{aligned}\end{split}
\end{equation}
\sphinxstepscope


\chapter{Governing Equations}
\label{\detokenize{ch/continuum/governing-equations:governing-equations}}\label{\detokenize{ch/continuum/governing-equations:continuum-governing-equations}}\label{\detokenize{ch/continuum/governing-equations::doc}}
\sphinxAtStartPar
The following process is detailed in the following sections

\sphinxAtStartPar
\sphinxstylestrong{Integral balance equations for primary physical quantities.} First, integral balance equations for closed systems are written as a manifestation of principles of classical mechanics for closed systems, namely mass conservation, second principle of mehcanics, and first principle of thermodynamics. Starting from integral balance equations for closed systems (material systems, Lagrange description), Reynolds transport theorem is used to derive integral balance equations for open systems, either stationary in space (control volume, Eulerian description) or with arbitrary motion (arbitrary description).

\sphinxAtStartPar
\sphinxstylestrong{Differential balance equations for primary physical quantities.} Starting from integral balance equations, under the assumption of sufficient regularity of the physical quantities, divergence theorem and arbitrariety of the domain is used to derive differential (local) balance equations of primary physical quantities.

\sphinxAtStartPar
\sphinxstylestrong{Differential balance equations for derived physical quantities.} Starting from differential equations of primary physical quantities, differential balance equations are derived for other physical quantities, as an example kinetic energy, internal energy and entropy.

\sphinxAtStartPar
\sphinxstylestrong{Integral balance equations for derived physical quantities.} Starting from differential balance equations, and exploiting divergence theorem (in the “opposite direction” w.r.t. what has been done before, to get differential from integral equations), integral balance equations are derived for derived quantities.

\sphinxstepscope


\section{Integral Balance Equations of aaa physical quantities}
\label{\detokenize{ch/continuum/balance-primary-integral:integral-balance-equations-of-aaa-physical-quantities}}\label{\detokenize{ch/continuum/balance-primary-integral:continuum-governing-equations-primary-integral}}\label{\detokenize{ch/continuum/balance-primary-integral::doc}}
\sphinxAtStartPar
Classical physics relies on a small set of principles, usually formulated for closed systems.
\begin{itemize}
\item {} 
\sphinxAtStartPar
classical physics and chemistry rely on Lavoisier principle, or mass conservation in closed systems

\item {} 
\sphinxAtStartPar
classical (Newton) mechanics is built on 3 principles:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(1^{st}\) principle, or principle of inertia, dealing with the invariance of classical physics w.r.t. Galileian transformations

\item {} 
\sphinxAtStartPar
\(2^{nd}\) principle, or balance of momentum

\item {} 
\sphinxAtStartPar
\(3^{rd}\) principle, or action/reaction principle

\end{itemize}

\item {} 
\sphinxAtStartPar
classical thermodynamics:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(1^{st}\) principle, or balance of total energy

\item {} 
\sphinxAtStartPar
\(2^{nd}\) principle, describing irreversibility or natural tendencies in physical processes \sphinxhyphen{} positive dissipation of mechanical (macroscopic) energy and heat transfer “from hot to cold bodies” \sphinxhyphen{} in terms of entropy

\item {} 
\sphinxAtStartPar
\(3^{rd}\) principle, relating energy, entropy and thermodynamic temperature as positive physical quantity (it sets an absolute zero of the thermodynamic temperature, in the thermodynamic scale of temperature \sphinxhyphen{} Kelvin \(K\))

\end{itemize}

\item {} 
\sphinxAtStartPar
classical electromagnetism:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Electric charge conservation

\item {} 
\sphinxAtStartPar
Maxwell’s equations, relating electromagnetic field with charges and currents

\item {} 
\sphinxAtStartPar
Lorentz’s force, acting on charges in an electromagnetic field

\end{itemize}

\end{itemize}

\sphinxAtStartPar
Here, electromagnetic processes are not investigated. Dynamical equations for angular momentum and kinetic energy derived in classical mechanics are discussed later: integral balance equation of angular momentum relates changes of angular momentum of the system with external moments acting on it; differential balance equation of angular momentum reduces to the an identity \sphinxhyphen{} and thus it adds no information \sphinxhyphen{} for \sphinxstylestrong{non\sphinxhyphen{}polar media}; kinetic energy integral balance relates changes of kinetic energy of the system with the total mechanical power acting on the system, and it can be substracted from total energy to get internal energy of the system.


\subsection{Principles of classical mechanics for closed systems \sphinxhyphen{} Lagrangian description}
\label{\detokenize{ch/continuum/balance-primary-integral:principles-of-classical-mechanics-for-closed-systems-lagrangian-description}}\label{\detokenize{ch/continuum/balance-primary-integral:continuum-governing-equations-primary-integral-lagrange}}
\sphinxAtStartPar
\sphinxstylestrong{Mass balance equation: Lavoisier principle.}
\begin{equation*}
\begin{split}\frac{d}{dt} \int_{V_t} \rho = 0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Momentum balance equation: \(2^{nd}\) principle of Newton mechanics.}
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{V_t} \rho \vec{u} = \int_{V_t} \rho \vec{g} + \oint_{\partial V_t} \vec{t}_{\hat{n}} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Total energy balance equation: \(1^{st}\) principle of thermodynamics.}
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{V_t} \rho e^t = \int_{V_t} \rho \vec{g} \cdot \vec{u} + \oint_{\partial V_t} \vec{t}_{\hat{n}} \cdot \vec{u} - \oint_{\partial V_t} \vec{q} \cdot \hat{n} + \int_{V_t} \rho r \ .\end{split}
\end{equation*}

\subsection{Integral balance equations for arbitrary domains \sphinxhyphen{} arbitrary description}
\label{\detokenize{ch/continuum/balance-primary-integral:integral-balance-equations-for-arbitrary-domains-arbitrary-description}}\label{\detokenize{ch/continuum/balance-primary-integral:continuum-governing-equations-primary-integral-arbitrary}}
\sphinxAtStartPar
Using \sphinxhref{https://basics2022.github.io/bbooks-math-miscellanea/ch/tensor-algebra-calculus/time-derivative-of-integrals.html\#volume-density}{Reynolds transport theorem}, time derivative over the material volume \(V_t\) can be written in terms of the time derivative over volume \(v_t\) in arbitrary motion and a flux contribution across its boundary.

\sphinxAtStartPar
\sphinxstylestrong{Mass balance equation.}
\begin{equation*}
\begin{split}\frac{d}{dt} \int_{v_t} \rho + \oint_{\partial v_t} \rho ( \vec{u} - \vec{u}_b ) \cdot \vec{\hat{n}} = 0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Momentum balance equation.}
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{v_t} \rho \vec{u} + \oint_{\partial v_t} \rho \vec{u} ( \vec{u} - \vec{u}_b ) \cdot \vec{\hat{n}} = \int_{v_t} \rho \vec{g} + \oint_{\partial v_t} \vec{t}_{\vec{n}} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Total energy balance equation.}
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{v_t} \rho e^t + \oint_{\partial v_t} \rho e^t ( \vec{u} - \vec{u}_b ) \cdot \vec{\hat{n}} = \int_{v_t} \rho \vec{g} \cdot \vec{u} + \oint_{\partial v_t} \vec{t}_{\vec{n}} \cdot \vec{u} - \oint_{\partial v_t} \vec{q} \cdot \vec{\hat{n}} + \int_{v_t} \rho r \ .\end{split}
\end{equation*}
\begin{sphinxadmonition}{note}{How to correctly apply Reynolds’s transport theorem in continuum mechanics}

\sphinxAtStartPar
Apply Reynold’s transport both to material volume \(V_t\) and arbitrary volume \(v_t\)
\begin{equation*}
\begin{split}\begin{aligned}
  \dfrac{d}{d t} \int_{V_t} f & = \int_{V_t}\dfrac{\partial f}{\partial t} + \oint_{\partial V_t} f \, \vec{v}   \cdot \hat{n} \\
  \dfrac{d}{d t} \int_{v_t} f & = \int_{v_t}\dfrac{\partial f}{\partial t} + \oint_{\partial v_t} f \, \vec{v}_b \cdot \hat{n}   
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and compare these two expressions, after setting \(v_t \equiv V_t\), i.e. considering the material volume at time \(t\) conciding with the arbitrary volume at time \(t\) (in general, at any time \(t\) there’s a different material volume \(V_t\) coinciding with the arbitrary volume \(v_t\) \sphinxhyphen{} i.e. a different set of material particles in the arbitrary volume \sphinxhyphen{} but this is not a problem at all in the manipulation),
\begin{equation*}
\begin{split}\dfrac{d}{d t} \int_{V_t \equiv v_t} f = \dfrac{d}{d t} \int_{v_t} f + \oint_{\partial V_t \equiv \partial v_t} f (\vec{v} - \vec{v}_b) \cdot \hat{n} \ .\end{split}
\end{equation*}\end{sphinxadmonition}


\subsection{Integral balance equations for control volumes \sphinxhyphen{} Eulerian description}
\label{\detokenize{ch/continuum/balance-primary-integral:integral-balance-equations-for-control-volumes-eulerian-description}}\label{\detokenize{ch/continuum/balance-primary-integral:continuum-governing-equations-primary-integral-euler}}
\sphinxAtStartPar
Eulerian description of integral balance equations in continuum mechanics relies on stationary control volume, \(V\). Integral balance equations are readily derived from {\hyperref[\detokenize{ch/continuum/balance-primary-integral:continuum-governing-equations-primary-integral-arbitrary}]{\sphinxcrossref{\DUrole{std,std-ref}{balance equations for arbitrary volumes}}}} setting the velocity of the boundary of the domain equal to zero, i.e. \(\vec{v}_b = \vec{0}\), and the Eulerian controlo volume equal to the “instantanteously coinciding material volume”, \(V \equiv V_t\).

\sphinxAtStartPar
\sphinxstylestrong{Mass balance equation}
\begin{equation*}
\begin{split}\frac{d}{dt} \int_{V} \rho + \oint_{\partial V} \rho \vec{u} \cdot \vec{\hat{n}} = 0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Momentum balance equation}
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{V} \rho \vec{u} + \oint_{\partial V} \rho \vec{u} \vec{u} \cdot \vec{\hat{n}} = \int_{V} \rho \vec{g} + \oint_{\partial V} \vec{t}_{\vec{n}} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Total energy balance equation.}
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{V} \rho e^t + \oint_{\partial V} \rho e^t \vec{u} \cdot \vec{\hat{n}} = \int_{V} \rho \vec{g} \cdot \vec{u} + \oint_{\partial V} \vec{t}_{\vec{n}} \cdot \vec{u} - \oint_{\partial V} \vec{q} \cdot \vec{\hat{n}} + \int_{V} \rho r \ .\end{split}
\end{equation*}
\sphinxstepscope


\section{Differential Balance Equations of aaa physical quantities}
\label{\detokenize{ch/continuum/balance-primary-differential:differential-balance-equations-of-aaa-physical-quantities}}\label{\detokenize{ch/continuum/balance-primary-differential:continuum-governing-equations-primary-integral}}\label{\detokenize{ch/continuum/balance-primary-differential::doc}}

\subsection{Balance equation in physical space}
\label{\detokenize{ch/continuum/balance-primary-differential:balance-equation-in-physical-space}}\label{\detokenize{ch/continuum/balance-primary-differential:continuum-governing-equations-primary-integral-physical}}
\sphinxAtStartPar
In this section, differential form of balance equations is derived using time \(t\) and physical coordinate \(\vec{r}\) as independent variables of fields representing physical quantities \(f(\vec{r},t)\).

\sphinxAtStartPar
\sphinxstylestrong{Conservative form \sphinxhyphen{} Eulerian description in physical space.}
\begin{equation}\label{equation:ch/continuum/balance-primary-differential:eq:continuum:primary:differential:conservative}
\begin{split}\begin{aligned}
 & \dfrac{\partial \rho }{\partial t} + \nabla \cdot \left( \rho \vec{v} \right) = 0 \\
 & \dfrac{\partial }{\partial t} \left( \rho \vec{v} \right) +  \nabla \cdot \left( \rho \vec{v} \otimes \vec{v} \right) = \rho \vec{g} + \nabla \cdot \mathbb{T} \\
 & \dfrac{\partial}{\partial t}  \left( \rho e^t \right) + \nabla \cdot \left( \rho e^t \vec{v} \right) = \rho \vec{g} \cdot \vec{v} + \nabla \cdot \left( \mathbb{T} \cdot \vec{v} \right) - \nabla \cdot \vec{q} + \rho r
\end{aligned}\end{split}
\end{equation}
\sphinxAtStartPar
\sphinxstylestrong{Convective form \sphinxhyphen{} Lagrangian description in physical space.} Using vector calculus identities to evaluate partial derivatives of products, mass equation and relation \eqref{equation:ch/continuum/kinematics:eq:field-time-derivatives} to write partial derivative w.r.t. material derivative,
\begin{equation*}
\begin{split}\begin{aligned}
 &      \dfrac{D \rho   }{D t} = - \rho \nabla \cdot \vec{v} \\
 & \rho \dfrac{D \vec{v}}{D t} = \rho \vec{g} + \nabla \cdot \mathbb{T} \\
 & \rho \dfrac{D e^t    }{D t} = \rho \vec{g} \cdot \vec{v} + \nabla \cdot \left( \mathbb{T} \cdot \vec{v} \right) - \nabla \cdot \vec{q} + \rho r
\end{aligned}\end{split}
\end{equation*}\subsubsection*{Proof}

\sphinxAtStartPar
\sphinxstylestrong{todo}

\sphinxAtStartPar
\sphinxstylestrong{Arbitrary description in physical space.} Using relation \eqref{equation:ch/continuum/kinematics:eq:field-time-derivatives} to write material derivatives w.r.t. time derivative at constant \(\vec{r}_b\)
\begin{equation*}
\begin{split}\begin{aligned}
 &      \left.\dfrac{\partial \rho   }{\partial t}\right|_{\vec{r}_b} + \left( \vec{v} - \vec{v}_b \right) \cdot \nabla \rho    = - \rho \nabla \cdot \vec{v} \\
 & \rho \left.\dfrac{\partial \vec{v}}{\partial t}\right|_{\vec{r}_b} + \rho \left( \vec{v} - \vec{v}_b \right) \cdot \nabla \vec{v} = \rho \vec{g} + \nabla \cdot \mathbb{T} \\
 & \rho \left.\dfrac{\partial e^t    }{\partial t}\right|_{\vec{r}_b} + \rho \left( \vec{v} - \vec{v}_b \right) \cdot \nabla e^t     = \rho \vec{g} \cdot \vec{v} + \nabla \cdot \left( \mathbb{T} \cdot \vec{v} \right) - \nabla \cdot \vec{q} + \rho r
\end{aligned}\end{split}
\end{equation*}

\subsection{Balance equations in reference space}
\label{\detokenize{ch/continuum/balance-primary-differential:balance-equations-in-reference-space}}\label{\detokenize{ch/continuum/balance-primary-differential:continuum-governing-equations-primary-integral-reference}}
\sphinxAtStartPar
In this section, differential form of balance equations is derived using time \(t\) and material coordinate \(\vec{r}_0\) as independent variables of fields representing physical quantities \(f_0(\vec{r}_0,t) = f(\vec{r}(\vec{r}_0, t), t)\), exploiting the change of variables \(\vec{r}(\vec{r}_0, t)\) and its inverse transformation \sphinxhyphen{} assumed to exist (with the same consideration done in the kinematics sections: while it’s likely that a global invertible transformation w.r.t. the original reference configuration doesn’t exist, limiting the time interval and space domain a “piecewise” invertible transformation w.r.t. intermetdiate states exists).



\sphinxstepscope


\section{Differential Balance Equations of ddd physical quantities}
\label{\detokenize{ch/continuum/balance-derived-differential:differential-balance-equations-of-ddd-physical-quantities}}\label{\detokenize{ch/continuum/balance-derived-differential:continuum-governing-equations-primary-integral}}\label{\detokenize{ch/continuum/balance-derived-differential::doc}}
\sphinxAtStartPar
Balance equations of kinetic energy, internal energy and entropy
\begin{equation*}
\begin{split}k = \frac{|\vec{v}|^2}{2} \quad , \qquad e = e^t - k \quad , \qquad s = \dots\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Convective form \sphinxhyphen{} Lagrangian description in physical space.} Kinetic energy equation is derived multiplying the momentum equation by the velocity field; internal energy equation is derived subtracting kinetic energy equation from the total energy equation; entropy equation strongly depends on the constitutive equation of the material, as it’s shown for elastic solids and Newtonian fluids
\begin{equation*}
\begin{split}\begin{aligned}
 & \rho \frac{D k}{D t} = \rho \vec{g} \cdot \vec{v} + \vec{v} \cdot \nabla \cdot \mathbb{T} \\
 & \rho \frac{D e}{D t} = \mathbb{T} : \nabla \vec{v} - \nabla \cdot \vec{q} + \rho r \\
 & \dots
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Conservative form \sphinxhyphen{} Eulerian description in physical space.}
\begin{equation*}
\begin{split}\begin{aligned}
 & \frac{\partial }{\partial t}\left(\rho k\right) + \nabla \cdot \left( \rho k \vec{v} \right) = \rho \vec{g} \cdot \vec{v} + \vec{v} \cdot \nabla \cdot \mathbb{T} \\
 & \frac{\partial }{\partial t}\left(\rho e\right) + \nabla \cdot \left( \rho e \vec{v} \right) = \mathbb{T} : \nabla \vec{v} - \nabla \cdot \vec{q} + \rho r \\
 & \dots
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Arbitrary description in physical space.}
\begin{equation*}
\begin{split}\begin{aligned}
 & \rho \left.\frac{\partial k}{\partial t}\right|_{\vec{r}_b} + \rho \left( \vec{v} - \vec{v}_b \right) \cdot \nabla k = \rho \vec{g} \cdot \vec{v} + \vec{v} \cdot \nabla \cdot \mathbb{T} \\
 & \rho \left.\frac{\partial e}{\partial t}\right|_{\vec{r}_b} + \rho \left( \vec{v} - \vec{v}_b \right) \cdot \nabla e = \mathbb{T} : \nabla \vec{v} - \nabla \cdot \vec{q} + \rho r \\
 & \dots
\end{aligned}\end{split}
\end{equation*}


\sphinxstepscope


\section{Integral Balance Equations of ddd physical quantities}
\label{\detokenize{ch/continuum/balance-derived-integral:integral-balance-equations-of-ddd-physical-quantities}}\label{\detokenize{ch/continuum/balance-derived-integral:continuum-governing-equations-primary-integral}}\label{\detokenize{ch/continuum/balance-derived-integral::doc}}


\sphinxstepscope


\section{Jump conditions}
\label{\detokenize{ch/continuum/balance-jump:jump-conditions}}\label{\detokenize{ch/continuum/balance-jump:continuum-governing-equations-jump-conditions}}\label{\detokenize{ch/continuum/balance-jump::doc}}
\sphinxAtStartPar
Jump conditions comes from integral balances for an anrbitrary domain. These conditions hold both across discontinuities \sphinxhyphen{} where fields are not regular enough for differential equations to hold \sphinxhyphen{} and in regular domains.

\sphinxstepscope


\section{Integral Balance Equations in reference space}
\label{\detokenize{ch/continuum/balance-reference-integral:integral-balance-equations-in-reference-space}}\label{\detokenize{ch/continuum/balance-reference-integral:continuum-governing-equations-reference-integral}}\label{\detokenize{ch/continuum/balance-reference-integral::doc}}

\subsection{Mass}
\label{\detokenize{ch/continuum/balance-reference-integral:mass}}\label{\detokenize{ch/continuum/balance-reference-integral:continuum-governing-equations-reference-integral-mass}}
\sphinxAtStartPar
Integal balance for a material volume \(V_t\) reads
\begin{equation*}
\begin{split}\begin{aligned}
  0 
  & = \dfrac{d}{dt}\int_{V_t} \rho(\vec{r}, t) \, dV = \\
  & = \dfrac{d}{dt}\int_{V_0} \rho(\vec{r}(\vec{r}_0,t), t) \, J(\vec{r}_0,t) \, dV_0 = \\
  & = \dfrac{d}{dt}\int_{V_0} \rho_0(\vec{r}_0,t) \, J(\vec{r}_0,t) \, dV_0 = \\
  & = \int_{V_0} \dfrac{D}{D t} \left( \rho_0(\vec{r}_0,t) \, J(\vec{r}_0,t) \right) \, dV_0 \ . 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Since the domain \(V_0\) is arbitrary, with some abuse of notation to indicate the density field as \(\rho\), hidihg the dependence on the independet fvariables \(\rho_0(\vec{r}_0,t)\), the differential balance in reference space follows
\begin{equation*}
\begin{split}\dfrac{D}{Dt} \left( \rho \, J \right) = 0\end{split}
\end{equation*}
\sphinxAtStartPar
or
\begin{equation*}
\begin{split}\rho \, J = \rho^0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
i.e. the product \(\rho \, J\) equals the initial density field \(\rho^0\), assuming that the determinant of the transformation is \(J^0 = 1\), in the reference configuration.


\subsection{Momentum}
\label{\detokenize{ch/continuum/balance-reference-integral:momentum}}\label{\detokenize{ch/continuum/balance-reference-integral:continuum-governing-equations-reference-integral-momentum}}
\sphinxAtStartPar
Integral balance for a material volume \(V_t\) reads
\begin{equation*}
\begin{split}\begin{aligned}
  & \dfrac{d}{dt}\int_{V_t} \rho \vec{v} \, dV = \int_{V_t} \rho \vec{g} + \oint_{\partial V_t} \hat{n} \cdot \mathbb{T} \, dS \\
  & \dfrac{d}{dt}\int_{V_0} \rho \, J \, \vec{v} \, dV_0 = \int_{V_0} \rho \, J \, \vec{g} + \oint_{\partial V_t} \hat{n}_0 \cdot \left( J \mathbb{F}^{-T} \cdot \mathbb{T} \right) \, d S_0 \\
  & \dfrac{d}{dt}\int_{V_0} \rho^0 \, \vec{v} \, dV_0 = \int_{V_0} \rho^0 \, \vec{g} + \oint_{\partial V_0} \hat{n}_0 \cdot \mathbb{\Sigma}_n \, d S_0 \\
  & \int_{V_0} \rho^0 \, \dfrac{D}{Dt} \vec{v} \, dV_0 = \int_{V_0} \rho^0 \, \vec{g} + \oint_{V_0} \nabla_0 \cdot \mathbb{\Sigma}_n \, d S_0 \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Since the domain \(V_0\) is arbitrary, the differential balance in reference space follows
\begin{equation*}
\begin{split}\rho^0 \dfrac{D \vec{v}}{D t} = \rho^0 \, \vec{g} + \nabla_0 \cdot \mathbb{\Sigma}_n\end{split}
\end{equation*}\subsubsection*{Nanson’s formula}
\begin{equation*}
\begin{split}d \vec{r} = d \vec{r}_0 \cdot \dfrac{\partial \vec{r}}{\partial \vec{r}_0} = d \vec{r}_0 \cdot \nabla_0 \vec{r} = d \vec{r}_0 \cdot \mathbb{F}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  dV & = J \, dV_0 \\
  d \vec{r} \cdot \hat{n} dS & = J \, d \vec{r}_0 \cdot \hat{n}_0 \, dS_0 \\
  d \vec{r}_0 \cdot \mathbb{F} \cdot \hat{n} \, dS & = J \, d \vec{r}_0 \cdot \hat{n}_0 \, dS_0 \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
must be true for all \(\vec{r}_0\) arbitrary, so that
\begin{equation*}
\begin{split}\mathbb{F} \cdot \hat{n} \, d S = J \, \hat{n}_0 \, d S_0\end{split}
\end{equation*}
\sphinxAtStartPar
and
\begin{equation*}
\begin{split}\begin{aligned}
  \hat{n} \, d S
  & = J \, \mathbb{F}^{-1}  \cdot  \hat{n}_0 \, d S_0 = \\
  & = J \, \hat{n}_0 \cdot \mathbb{F}^{-T} \, d S_0
\end{aligned}\end{split}
\end{equation*}\subsubsection*{Stress tensors}

\sphinxAtStartPar
\sphinxstylestrong{Cauchy stress tensor.}

\sphinxAtStartPar
\sphinxstylestrong{Piola\sphinxhyphen{}Kirchhoff I \sphinxhyphen{} transpose of normal stress tensors.}

\sphinxAtStartPar
\sphinxstylestrong{Piola\sphinxhyphen{}Kirchhoff II}
\label{ch/continuum/balance-reference-integral:example-0}
\begin{sphinxadmonition}{note}{Example 2.6.1 (Relation between description in physical and reference space)}


\begin{equation*}
\begin{split}\begin{aligned}
  \rho^0 \dfrac{D \vec{v}}{D t} & = \rho^0 \, \vec{g} + \nabla_0 \cdot \mathbb{\Sigma}_n \\
  J \, \rho \, \dfrac{D \vec{v}}{D t} & = J \, \rho \, \vec{g} + \nabla_0 \cdot \mathbb{\Sigma}_n \\
  \rho \, \dfrac{D \vec{v}}{D t} & = \rho \, \vec{g} + \frac{1}{J} \nabla_0 \cdot \mathbb{\Sigma}_n \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
thus,
\begin{equation*}
\begin{split}\begin{aligned}
  \nabla \cdot \mathbb{T}
  & = \frac{1}{J} \nabla_0 \cdot \mathbb{\Sigma}_n = \\
  & = \frac{1}{J} \nabla_0 \cdot \left( J \, \mathbb{F}^{-T} \cdot \mathbb{T}  \right) 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} Prove it with derivation!
\end{sphinxadmonition}


\subsection{Kinetic energy}
\label{\detokenize{ch/continuum/balance-reference-integral:kinetic-energy}}\label{\detokenize{ch/continuum/balance-reference-integral:continuum-governing-equations-reference-integral-kinetic-energy}}\begin{equation*}
\begin{split}\begin{aligned}
  0
  & = \vec{v} \cdot \left\{ \rho^0 \dfrac{D \vec{v}}{D t} - \rho^0 \vec{g} - \nabla_0 \cdot \mathbb{\Sigma}_n \right\} = \\
  & = \rho^0 \dfrac{D}{D t}\dfrac{|\vec{v}|^2}{2} - \rho^0 \vec{v} \cdot \vec{g} - \vec{v} \cdot \nabla_0 \cdot \mathbb{\Sigma}_n = \\
  & = \rho^0 \dfrac{D}{D t}\dfrac{|\vec{v}|^2}{2} - \rho^0 \vec{v} \cdot \vec{g} - \nabla_0 \cdot \left( \vec{v} \cdot  \mathbb{\Sigma}_n \right) + \nabla_0 \vec{v} :  \mathbb{\Sigma}_n 
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}v_i \partial^0_k \Sigma_{ki} = \partial^0_k \left( v_i \Sigma_{ki} \right) - \partial^0_k v_i \Sigma_{ki}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
 & d V = J d V_0 \\
 & dr_i n_i \, dS = J dr^0_{k} n^0_k \, dS_0 \\
 & dr^0_k \dfrac{\partial r_i}{\partial r^0_k} n_i \, dS = dr^0_{k} J n^0_k \, dS_0 \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \dfrac{\partial r_i}{\partial r^0_k} n_i \, dS & = J n^0_k \, dS_0 \\
  \underbrace{\dfrac{\partial r^0_k}{\partial r_j} \dfrac{\partial r_i}{\partial r^0_k}}_{=\delta_{ij}} n_i \, dS & = J \dfrac{\partial r^0_k}{\partial r_j} n^0_k \, dS_0 \\
  n_j \, dS & = J \frac{\partial r^0_k}{\partial r_j} n_k^0 \, dS_0
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbb{F} = \hat{e}^0_k \hat{e}^0_i \dfrac{\partial r_i}{\partial r^0_k}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbb{F}^{-1} = \hat{e}^0_j \hat{e}^0_k \dfrac{\partial r^0_k}{\partial r_j}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
\mathbb{F}^{-1} \cdot \mathbb{F} & = \left( \hat{e}^0_j \hat{e}^0_k \dfrac{\partial r^0_k}{\partial r_j} \right) \cdot \left( \hat{e}^0_l \hat{e}^0_i \dfrac{\partial r_i}{\partial r^0_l} \right) = \hat{e}^0_j \hat{e}^0_i \dfrac{\partial r^i}{\partial r_j} =  \hat{e}^0_j \hat{e}^0_i \delta_{ij} \\
\mathbb{F} \cdot \mathbb{F}^{-1} & = \left( \hat{e}^0_l \hat{e}^0_i \dfrac{\partial r_i}{\partial r^0_l} \right) \cdot \left( \hat{e}^0_j \hat{e}^0_k \dfrac{\partial r^0_k}{\partial r_j} \right) = \hat{e}^0_l \hat{e}^0_k \dfrac{\partial r^k}{\partial r_l} =  \hat{e}^0_l \hat{e}^0_k \delta_{lk} \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\frac{\partial r^0_k}{\partial r_i} \frac{\partial r_i}{\partial r^0_l} = \delta_{kl}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbb{\Sigma} := \mathbb{\Sigma}_n \cdot \mathbb{F}^{-1} = J \mathbb{F}^{-T} \cdot \mathbb{T} \cdot \mathbb{F}^{-1}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbb{\Sigma}_n = \mathbb{\Sigma} \cdot \mathbb{F}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\Sigma_{ik} = \Sigma_{n, ij} \left( \mathbb{F}^{-1} \right)_{jk} = \Sigma_{n, ij} \frac{\partial r^0_k}{\partial r_j}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\Sigma_{n, ij} = \Sigma_{ik} \dfrac{\partial x_j}{\partial x^0_k}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \nabla_0 \vec{v} : \mathbb{\Sigma}_n 
  & = \frac{D}{Dt} \mathbb{F} : \mathbb{\Sigma}_n = \\
  & = \dfrac{\partial v_j}{\partial x^0_i} \, \Sigma_{n, ij} = \\
  & = \dfrac{\partial v_j}{\partial x^0_i} \, \Sigma_{ik} \, \dfrac{\partial x_j}{\partial x^0_k} = \\
  & = \Sigma_{ik} \, \frac{1}{2} \left( \, \dfrac{\partial v_j}{\partial x^0_i} \, \dfrac{\partial x_j}{\partial x^0_k} + \dfrac{\partial v_j}{\partial x^0_k} \, \dfrac{\partial x_j}{\partial x^0_i} \, \right)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
if \(\mathbb{\Sigma}\) is symmetric, \(\Sigma_{ik} = \Sigma_{ki}\), or with tensor notation
\begin{equation*}
\begin{split}\begin{aligned}
  \nabla_0 \vec{v} : \mathbb{\Sigma}_n
  & = \dfrac{D}{D t} \mathbb{F} : \mathbb{\Sigma}_n = \\
  & = \nabla_0 \vec{v} : \left( \mathbb{\Sigma} \cdot \mathbb{F} \right) = \\
  & = \mathbb{\Sigma} : \frac{1}{2} \left( \dfrac{D \mathbb{F}}{D t} \cdot \mathbb{F}^T + \mathbb{F} \cdot \frac{D \mathbb{F}^T}{D t}  \right) = \\
  & = \mathbb{\Sigma} : \dfrac{D}{Dt} \mathbb{E} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having recognized the time derivative \eqref{equation:ch/continuum/kinematics:eq:green-lagrange:dt} of the {\hyperref[\detokenize{ch/continuum/kinematics:kinematics-reference-space-strain-green-lagrange}]{\sphinxcrossref{\DUrole{std,std-ref}{Green\sphinxhyphen{}Lagrange tensor}}}} \eqref{equation:ch/continuum/kinematics:eq:green-lagrange}.

\sphinxAtStartPar
Integral of the volume stress in the reference space can be recast as the volume in the physical space
\begin{equation*}
\begin{split}\int_{V_0} \nabla_0 \vec{v} : \mathbb{\Sigma}_n \, dV_0 = \int_{V_0} \mathbb{\Sigma} : \dfrac{D \mathbb{E}}{D t} \, d V_0 \end{split}
\end{equation*}\begin{equation*}
\begin{split}\Sigma_{n, ik} = J \, \dfrac{\partial x^0_i}{\partial x_k} \, T_{jk}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \int_{V_0} \nabla_0 \vec{v} : \mathbb{\Sigma}_n \, dV_0 
  & =  \int_{V_0} \dfrac{\partial v_k}{\partial x^0_i} \Sigma_{n, ik} \, dV_0 = \\
  & =  \int_{V_0} \underbrace{\dfrac{\partial v_k}{\partial x^0_i} \left( \dfrac{\partial x^0_i}{\partial x_j} \right.}_{}  \, T_{kj}  \underbrace{J\, \bigg) dV_0}_{d V} = \\
  & =  \int_{V} \dfrac{\partial v_k}{\partial x^j} \, T_{kj} \, d V = \\
  & =  \int_{V} \frac{1}{2} \left( \dfrac{\partial v_k}{\partial x^j} + \dfrac{\partial v_j}{\partial x^k} \right) \, T_{kj} \, d V = \\
  & =  \int_{V} D_{jk} \, T_{kj} \, d V = \\
  & =  \int_{V} \mathbb{D} : \mathbb{T} \, d V  \ .
\end{aligned}\end{split}
\end{equation*}

\subsubsection{Variational principles}
\label{\detokenize{ch/continuum/balance-reference-integral:variational-principles}}
\sphinxAtStartPar
Using an arbitrary test function \(\vec{w}(\vec{r}_0)\),
\begin{equation*}
\begin{split}0 = \vec{w} \cdot \left\{ \rho^0 \dfrac{D \vec{v}}{D t} - \rho^0 \vec{g} - \nabla_0 \cdot \mathbb{\Sigma}_n \right\}\end{split}
\end{equation*}
\sphinxAtStartPar
and using rule of product
\begin{equation*}
\begin{split}\begin{aligned}
  w_i \dfrac{\partial \Sigma_{n,ji}}{\partial x^0_j} 
  & = \dfrac{\partial }{\partial x^0_j} \left( w_i \Sigma_{n, ji} \right) - \dfrac{\partial w_i}{\partial x^0_j} \Sigma_{n, ji} = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and the second term can be transformed using the relation bewteen normal stress and second Piola\sphinxhyphen{}Kirchhoff tensor
\begin{equation*}
\begin{split}\begin{aligned}
  \dfrac{\partial w_i}{\partial x^0_j} \Sigma_{n, ji} = \dfrac{\partial w_i}{\partial x^0_j} \Sigma_{jk} \dfrac{\partial x_i}{\partial x^0_k}
  = \Sigma_{jk} \, \dfrac{1}{2} \, \left[ \, \dfrac{\partial x_i}{\partial x^0_k} \dfrac{\partial w_i}{\partial x^0_j} + \dfrac{\partial x_i}{\partial x^0_j} \dfrac{\partial w_i}{\partial x^0_k} \, \right] = \Sigma_{jk} \, W_{ij}(\vec{w}) \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having defined the tensor
\begin{equation*}
\begin{split}\mathbb{W}(\vec{w}) := \dfrac{1}{2} \left[ \, \nabla_0 \vec{w} \cdot \mathbb{F}^T + \mathbb{F} \cdot \nabla^T_0 \vec{w} \, \right] \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with the evident analogy with the time derivative of Green\sphinxhyphen{}Lagrange strain tensor, namely
\begin{equation*}
\begin{split}\mathbb{\epsilon} = \mathbb{W}(\vec{v}) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
being \(\vec{v}\) the velocity field. Integrating on the domain \(V_0\) and using divergence theorem, the problem is written in its weak form
\begin{equation*}
\begin{split}\int_{V_0} \left\{ \rho^0 \vec{w} \cdot \dfrac{D \vec{v}}{D t} + \mathbb{W}(\vec{w}) : \mathbb{\Sigma} \right\} = \int_{V_0} \rho^0 \vec{w} \cdot \vec{g} + \oint_{\partial V_0} \hat{n}_0 \cdot \mathbb{\Sigma}_n \cdot \vec{w} \ , \end{split}
\end{equation*}
\sphinxAtStartPar
with the proper boundary conditions and the corresponding conditions on the test function \(\vec{w}\). As an example, if the boundary is composed of two different regions, \(S_{D,0} \cup S_{N,0} = \partial V_0\), \(S_D \cap S_N = \emptyset\) where either position (called \(S_D\) from Dirichlet boundary) and stress (called \(S_N\) from Neumann boundary) are prescribed
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{r} = \vec{r}_b \qquad , \qquad & \vec{w} = \vec{0} & \qquad \text{(on $ S_{D,0} $ Dirichlet - essential - boundary)} \\
  \hat{n}_0 \cdot \mathbb{\Sigma}_n = \vec{t}_{0, \hat{n}_0} \qquad , \qquad & & \text{(on $ S_{N,0} $ Neumann - natural - boundary)} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
the weak form of the equation reads
\begin{equation*}
\begin{split}\int_{V_0} \left\{ \rho^0 \vec{w} \cdot \dfrac{D \vec{v}}{D t} + \mathbb{W}(\vec{w}) : \mathbb{\Sigma} \right\} = \int_{V_0} \rho^0 \vec{w} \cdot \vec{g} + \int_{S_{n,0}} \hat{n}_0 \cdot \vec{t}_{\hat{n}_0} \end{split}
\end{equation*}

\subsection{Total energy}
\label{\detokenize{ch/continuum/balance-reference-integral:total-energy}}\label{\detokenize{ch/continuum/balance-reference-integral:continuum-governing-equations-reference-integral-total-energy}}
\sphinxAtStartPar
Using Nanson’s relation \(\hat{n} \, dS = \hat{n}_0 \cdot \left(J \mathbb{F}^{-T}\right) \, d S_0\),
\begin{equation*}
\begin{split}\begin{aligned}
  \dfrac{d}{d t} \int_{V_t} \rho e^t \, dV
  & = \int_{V_t} \rho \vec{g} \cdot \vec{v} \, dV + \oint_{\partial V_t} \vec{t}_{\hat{n}} \cdot \vec{v}  \, dS - \oint_{\partial V_t} \hat{n} \cdot \vec{q} + \int_{V_t} \rho \, r \, dV = \\
  & = \int_{V_t} \rho \vec{g} \cdot \vec{v} \, dV + \oint_{\partial V_t} \hat{n} \cdot \mathbb{T} \cdot \vec{v} \, dS - \oint_{\partial V_t} \hat{n} \cdot \vec{q} \, dS + \int_{V_t} \rho \, r \, dV \\
  & = \int_{V_0} \rho^0 \, \vec{g} \cdot \vec{v} \, dV_0 + \oint_{\partial V_0} \hat{n}_0 \cdot \left( J \mathbb{F}^{-T} \cdot \mathbb{T} \right) \cdot \vec{v} \, dS_0 - \oint_{\partial V_0} \hat{n}_0 \cdot \left( J \mathbb{F}^{-T} \cdot \vec{q} \right) \, dS_0 + \int_{V_0} \rho^0 \, r \, dV_0 \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and the differential form reads
\begin{equation*}
\begin{split}
\rho^0 \dfrac{D e^t}{Dt} = \rho^0 \vec{g} \cdot \vec{v} + \nabla_0 \cdot \left( J \mathbb{F}^{-T} \cdot \mathbb{T} \cdot \vec{v} \right) - \nabla_0 \cdot \left( J \mathbb{F}^{-T} \cdot \vec{q} \right) + \rho^0 \, r \ .
\end{split}
\end{equation*}
\sphinxAtStartPar
or
\begin{equation*}
\begin{split}
\rho^0 \dfrac{D e^t}{Dt} = \rho^0 \vec{g} \cdot \vec{v} + \nabla_0 \cdot \left( \mathbb{\Sigma}_n \cdot \vec{v} \right) - \nabla_0 \cdot \vec{q}_0 + \rho^0 \, r \ .
\end{split}
\end{equation*}
\sphinxAtStartPar
and dividing by \(J\) and using the relation (\sphinxstylestrong{see below}) \(\nabla_0 \cdot ( J \mathbb{F}^{-T} \cdot \vec{a} ) = J \, \nabla \cdot \vec{a}\),
\begin{equation*}
\begin{split}\rho \dfrac{D e^t}{D t} = \rho \vec{g} \cdot \vec{v} + \nabla \cdot \left( \mathbb{T} \cdot \vec{v} \right) - \nabla \cdot \vec{q} + \rho r \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Comparison with equation in physical space (dividing by \(J\)) suggests the identity
\begin{equation*}
\begin{split}\dfrac{1}{J} \nabla_0 \cdot \left( J \mathbb{F}^{-T} \cdot \vec{a} \right) = \nabla \cdot \vec{a} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and thus
\begin{equation*}
\begin{split}\nabla_0 \cdot ( J \mathbb{F}^{-T} ) = \vec{0} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
since
\begin{equation*}
\begin{split}
\nabla_0 \cdot \left( J \mathbb{F}^{-T} \cdot \vec{a} \right) 
= \nabla_0 \cdot \left( J \mathbb{F}^{-T} \right) \cdot \vec{a}
+ J \mathbb{F}^{-T} : \nabla_0 \vec{a} = 
 \nabla_0 \cdot \left( J \mathbb{F}^{-T} \right) \cdot \vec{a} + J \nabla \cdot \vec{a}
\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Proof.}
\begin{equation*}
\begin{split}J = \left| \dfrac{\partial r_k}{\partial r^0_i} \right| = \varepsilon_{i_1, i_2, i_3} \dfrac{\partial r_{i_1}}{\partial r^0_1} \dfrac{\partial r_{i_2}}{\partial r^0_2} \dfrac{\partial r_{i_3}}{\partial r^0_3}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\left( \mathbb{F}^{-T} \right)_{ij} = \dfrac{\partial r^0_i}{\partial r_j}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
\left\{ \nabla_0 \cdot \left( J \, \mathbb{F}^{-T} \right) \right\}_j
 & = \dfrac{\partial }{\partial r_i^0} \left(  \varepsilon_{i_1, i_2, i_3} \dfrac{\partial r_{i_1}}{\partial r^0_1} \dfrac{\partial r_{i_2}}{\partial r^0_2} \dfrac{\partial r_{i_3}}{\partial r^0_3} \,  \dfrac{\partial r^0_i}{\partial r_j}\right) = \\
 & = \varepsilon_{i_1, i_2, i_3} \dfrac{\partial }{\partial r_i^0} \left(\dfrac{\partial r_{i_1}}{\partial r^0_1} \right)\dfrac{\partial r_{i_2}}{\partial r^0_2} \dfrac{\partial r_{i_3}}{\partial r^0_3} \,  \dfrac{\partial r^0_i}{\partial r_j} 
   + \varepsilon_{i_1, i_2, i_3} \dfrac{\partial r_{i_1}}{\partial r^0_1}  \dfrac{\partial }{\partial r_i^0} \left( \dfrac{\partial r_{i_2}}{\partial r^0_2} \right) \dfrac{\partial r_{i_3}}{\partial r^0_3} \,  \dfrac{\partial r^0_i}{\partial r_j} + \\
 & + \varepsilon_{i_1, i_2, i_3} \dfrac{\partial r_{i_1}}{\partial r^0_1} \, \dfrac{\partial r_{i_2}}{\partial r^0_2} \dfrac{\partial }{\partial r_i^0} \left(\dfrac{\partial r_{i_3}}{\partial r^0_3}\right) \,  \dfrac{\partial r^0_i}{\partial r_j} 
   + \varepsilon_{i_1, i_2, i_3}\dfrac{\partial r_{i_1}}{\partial r^0_1} \dfrac{\partial r_{i_2}}{\partial r^0_2} \dfrac{\partial r_{i_3}}{\partial r^0_3} \, \dfrac{\partial }{\partial r_i^0} \left(  \dfrac{\partial r^0_i}{\partial r_j} \right) = \\
 & = \varepsilon_{i_1, i_2, i_3}  \, \underbrace{\dfrac{\partial r^0_i}{\partial r_j}\dfrac{\partial }{\partial r_i^0}}_{= \frac{\partial }{\partial r_j}} \left(\dfrac{\partial r_{i_1}}{\partial r^0_1} \right)\dfrac{\partial r_{i_2}}{\partial r^0_2} \dfrac{\partial r_{i_3}}{\partial r^0_3} 
   + \varepsilon_{i_1, i_2, i_3}  \dfrac{\partial r_{i_1}}{\partial r^0_1} \underbrace{ \dfrac{\partial r^0_i}{\partial r_j} \dfrac{\partial }{\partial r_i^0}}_{= \frac{\partial }{\partial r_j}} \, \left(\dfrac{\partial r_{i_2}}{\partial r^0_2} \right) \dfrac{\partial r_{i_3}}{\partial r^0_3} + \\
 & + \varepsilon_{i_1, i_2, i_3} \dfrac{\partial r_{i_1}}{\partial r^0_1} \, \dfrac{\partial r_{i_2}}{\partial r^0_2} \underbrace{\dfrac{\partial r^0_i}{\partial r_j}\dfrac{\partial }{\partial r_i^0}}_{=\frac{\partial}{\partial r_j}} \, \left(\dfrac{\partial r_{i_3}}{\partial r^0_3}\right)  
   + \varepsilon_{i_1, i_2, i_3}\dfrac{\partial r_{i_1}}{\partial r^0_1} \dfrac{\partial r_{i_2}}{\partial r^0_2} \dfrac{\partial r_{i_3}}{\partial r^0_3} \, \dfrac{\partial }{\partial r_j} \underbrace{\left(  \dfrac{\partial r^0_i}{\partial r^0_i} \right)}_{=3} = \\
   & = 0 \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
since
\begin{equation*}
\begin{split}\dfrac{\partial }{\partial r_j} \left( \dfrac{\partial r_{i_k}}{\partial r^0_k} \right) = \dfrac{\partial }{\partial r^0_k} \left( \dfrac{\partial r_{i_k}}{\partial r^j} \right) = \dfrac{\partial}{\partial r^0_k} \delta_{i_k j} = 0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Thus
\begin{equation*}
\begin{split}\dfrac{1}{J}\dfrac{\partial}{\partial r^0_i} \left( J \dfrac{\partial r^0_i}{\partial r_j} a_j \right) = 
\dfrac{1}{J}\dfrac{\partial}{\partial r^0_i} \left( J \dfrac{\partial r^0_i}{\partial r_j} \right) a_j + \dfrac{1}{J} \, J \, \dfrac{\partial r^0_i}{\partial r_j} \, \dfrac{\partial a_j}{\partial r^0_i} = \dfrac{\partial a_j}{\partial r_j} = \nabla \cdot \vec{a} \ . \end{split}
\end{equation*}

\subsection{Internal energy}
\label{\detokenize{ch/continuum/balance-reference-integral:internal-energy}}\label{\detokenize{ch/continuum/balance-reference-integral:continuum-governing-equations-reference-integral-internal-energy}}\begin{equation*}
\begin{split}\begin{aligned}
  & \dfrac{d}{d t} \int_{V_t} \rho e \, dV = \int_{V_t} \mathbb{T} : \nabla \vec{v} \, dV - \oint_{\partial V_t} \hat{n} \cdot \vec{q} \, dS + \int_{V_t} \rho \, r \, dV = \\
  & \dfrac{d}{d t} \int_{V_0} \rho^0 e \, dV_0 = \int_{V_0} J \, \mathbb{T} : \nabla \vec{v} \, dV_0 - \oint_{\partial V_0} \hat{n}_0 \cdot \left( J \mathbb{F}^{-T} \cdot \vec{q} \right) \, dS_0 + \int_{V_0} \rho^0 \, r \, dV_0 = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and the differential form reads
\begin{equation*}
\begin{split}\rho^0 \dfrac{D e}{Dt} = \mathbb{\Sigma}_n : \nabla_0 \vec{v} - \nabla_0 \cdot \vec{q}^0 + \rho^0 r \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{pay attention at the definition \sphinxhyphen{} choose one and keep using it! \sphinxhyphen{} of the product \(\mathbb{A} : \mathbb{B}\)}, in components
\begin{equation*}
\begin{split}\mathbb{A} : \mathbb{B} = A_{ij} B_{ij} \qquad \text{or} \qquad = A_{ij} B_{ji}\end{split}
\end{equation*}
\sphinxstepscope


\chapter{Equazioni di stato ed equazioni costitutive}
\label{\detokenize{ch/continuum/constitutive-equations:equazioni-di-stato-ed-equazioni-costitutive}}\label{\detokenize{ch/continuum/constitutive-equations:continuum-constitutive-equations}}\label{\detokenize{ch/continuum/constitutive-equations::doc}}
\sphinxstepscope


\chapter{Equazioni di bilancio di altre grandezze fisiche}
\label{\detokenize{ch/continuum/derived-balances:equazioni-di-bilancio-di-altre-grandezze-fisiche}}\label{\detokenize{ch/continuum/derived-balances:continuum-derived-balances}}\label{\detokenize{ch/continuum/derived-balances::doc}}


\sphinxAtStartPar
Partendo dai bilanci di massa, quantità di moto e di energia totale, si possono ricare le le equazioni di bilancio di altre grandezze fisiche come l’\sphinxstyleemphasis{energia cinetica}, l’\sphinxstyleemphasis{energia interna}, l’\sphinxstyleemphasis{entropia}.


\section{Bilanci in forma differenziale, convettiva}
\label{\detokenize{ch/continuum/derived-balances:bilanci-in-forma-differenziale-convettiva}}
\sphinxAtStartPar
\sphinxstylestrong{Energia cinetica.} L’energia cinetica (macroscopica) per unità di massa è \(k = \frac{1}{2}|\mathbf{u}|^2 = \frac{1}{2} \mathbf{u} \cdot \mathbf{u}\). L’equazione di bilancio dell’energia cinetica viene derivata moltiplicando scalarmente l’equazione della quantità di moto
\begin{equation*}
\begin{split}\rho \dfrac{D \mathbf{u}}{Dt} = \rho \mathbf{g} + \nabla \cdot \mathbb{T} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
per il campo di velocità \(\mathbf{u}\),
\begin{equation*}
\begin{split}\rho \dfrac{D k}{Dt} = \rho \mathbf{g} \cdot \mathbf{u} + \nabla \cdot \mathbb{T} \cdot \mathbf{u} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
avendo usato \(\mathbf{u} \cdot d \mathbf{u} = d \left( \dfrac{\mathbf{u} \cdot \mathbf{u}}{2} \right) = dk\).

\sphinxAtStartPar
\sphinxstylestrong{Energia interna.} L’energia interna per unità di massa è la differenza tra l’energia totale e l’energia cinetica, \(e = e^{tot} - k\). L’equazione di bilancio dell’energia interna viene ottenuta come differenza dell’equazione dell’energia totale
\begin{equation*}
\begin{split}\rho \dfrac{D e^{tot}}{Dt} = \rho \mathbf{g} \cdot \mathbf{u} + \nabla \cdot (\mathbb{T} \cdot \mathbf{u}) - \nabla \cdot \mathbf{q} + \rho r \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
e quella dell’energia cinetica, per ottenere
\begin{equation*}
\begin{split}\rho \dfrac{D e}{D t} = \mathbb{T} : \nabla \mathbf{u} - \nabla \cdot \mathbf{q} + \rho r \ . \end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Entropia.}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Entropia nei fluidi.} Se l’entropia può essere scritta come funzione dell’energia interna e della densità, e il primo principio della termodinamica viene scritto come
\begin{equation*}
\begin{split}de = \frac{P}{\rho^2} \, d \rho + T \, ds \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
e il tensore degli sforzi può essere rappresentato come somma degli sforzi di pressione e degli sforzi viscosi \sphinxstylestrong{todo} \sphinxstyleemphasis{riferimento alle leggi costitutive},
\begin{equation*}
\begin{split}\mathbb{T} = - P \mathbb{I} + \mathbb{S} = - P \mathbb{I} + 2 \mu \mathbb{D} + \lambda (\nabla \cdot \mathbf{u}) \mathbb{I} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
si può ricavare l’equazione di governo dell’entropia usando il differenziale \(ds = \dfrac{1}{T} \, de - \dfrac{P}{T \rho^2} \, d \rho\)
\begin{equation*}
\begin{split}\begin{aligned}
    \rho \dfrac{D s}{D t} 
    & = \dfrac{\rho}{T} \left( \dfrac{D e }{D t} - \dfrac{P}{\rho^2} \dfrac{D \rho}{D t} \right) = \\
    & = \dfrac{1}{T} \left( \rho \dfrac{D e }{D t} - \dfrac{P}{\rho} \dfrac{D \rho}{D t} \right) = \\
    & = \dfrac{1}{T} \left( \mathbb{T} : \nabla \mathbf{u} - \nabla \cdot \mathbf{q} + \rho r - \dfrac{P}{\rho} \left( \rho \nabla \cdot \mathbf{u} \right) \right) = \\
    & = \dfrac{1}{T} \left( -P \nabla \cdot \mathbf{u} + \mathbb{S} : \nabla \mathbf{u} - \nabla \cdot \mathbf{q} + \rho r + P \ \nabla \cdot \mathbf{u}  \right) = \\
    & = \dfrac{1}{T} \left( \mathbb{S} : \nabla \mathbf{u} - \nabla \cdot \mathbf{q} + \rho r \right) = \\
    & = \dfrac{1}{T} \left( 2 \mu |\mathbb{D}|^2 + \lambda |(\nabla \cdot \mathbf{u})|^2 - \nabla \cdot \mathbf{q} + \rho r \right) = \\
    & = \dfrac{2 \mu |\mathbb{D}|^2 + \lambda |(\nabla \cdot \mathbf{u})|^2 }{T} - \frac{\mathbf{q} \cdot \nabla T}{T^2} - \nabla \cdot \left( \dfrac{\mathbf{q}}{T} \right) + \dfrac{\rho r}{T} \ , \\
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
avendo usato la degola del prodotto \(\nabla \cdot \left( \dfrac{\mathbf{q}}{T} \right) = \dfrac{\nabla \cdot \mathbf{q}}{T} - \dfrac{\mathbf{q} \cdot \nabla T}{T^2}\).

\sphinxAtStartPar
Gli ultimi due termini sono legati alla \sphinxstylestrong{sorgenti di entropia} nel sistema, dovute alla sorgente di calore nel sistema e al flusso di calore tramite la frontiera del sistema.

\sphinxAtStartPar
I primi due termini possono essere ricondotti alla \sphinxstylestrong{dissipazione viscosa} e dovuta alla \sphinxstylestrong{conduzione termica} all’interno del volume: entrambi devono essere non\sphinxhyphen{}negativi per il secondo principio della termodinamica \sphinxstylestrong{todo}. Il primo termine è positivo se i coefficienti di viscosità del modello di fluido newtoniano sono non\sphinxhyphen{}negativi
\begin{equation*}
\begin{split}\mu, \lambda \ge 0\end{split}
\end{equation*}
\sphinxAtStartPar
. Il secondo termine impone che il flusso di calore avvenga in direzione opposta al gradiente di temperatura locale, e quindi la proiezione su di esso sia negativa (traducendo il concetto che il calore trasferisce energia da un corpo caldo a uno freddo),
\begin{equation*}
\begin{split}- \mathbf{q} \cdot \nabla T \ge 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
come è facile da verificare per il modello di Fourier per la conduzione in mezzi isotropi, \(\mathbf{q} = - k \nabla T\), \(- \mathbf{q} \cdot \nabla T = k |\nabla T|^2 \ge 0\) se
\begin{equation*}
\begin{split}k \ge 0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Nel caso di modello lineare per la conduzione in mezzi non isotrpi, il flusso di conduzione può essere descritto usando un tensore del secondo ordine \(\mathbb{K}\), \(\mathbf{q} = - \mathbb{K} \cdot \nabla T\) (\sphinxstylestrong{todo} simmetria?) e la condizione diventa
\begin{equation*}
\begin{split}0 \le - \nabla T  \cdot \mathbf{q} = \nabla T \cdot \mathbb{K} \cdot \nabla T \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
che impone che il tensore di conduzione sia (semi\sphinxhyphen{})definito positivo, a causa dell’arbitrarietà del vettore \(\nabla T\).

\sphinxAtStartPar
Se questi due termini sono non\sphinxhyphen{}negativi, il bilancio di entropia può essere riscritto come la disuguaglianza
\begin{equation*}
\begin{split}\begin{aligned}
    \rho \dfrac{D s}{D t}
    & = \underbrace{\dfrac{2 \mu |\mathbb{D}|^2 + \lambda |(\nabla \cdot \mathbf{u})|^2 }{T} - \frac{\mathbf{q} \cdot \nabla T}{T^2}}_{\ge 0} - \nabla \cdot \left( \dfrac{\mathbf{q}}{T} \right) + \dfrac{\rho r}{T} = \\
    & \ge  - \nabla \cdot \left( \dfrac{\mathbf{q}}{T} \right) + \dfrac{\rho r}{T} \ ,
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
o nella forma integrale per un volume materiale
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{V_t} \rho s \ge - \oint_{\partial V_t} \mathbf{\hat{n}} \cdot \dfrac{\mathbf{q}}{T} + \int_{V_t} \rho \dfrac{r}{T} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
che richiama alla mente la disuguaglianza di Clausius \sphinxstylestrong{todo} \sphinxstyleemphasis{aggiungere riferimento}
\begin{equation*}
\begin{split}d S \ge \dfrac{\delta Q^{e}}{T} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
La differenza di segno deriva dalla definizione di \(d Q^e\) come flusso di calore dall’ambiente verso il sistema e del vettore flusso di calore \(\mathbf{q}\) come flusso di calore “uscente dal sistema” \sphinxstylestrong{todo}

\end{itemize}

\sphinxstepscope


\part{Solid Mechanics}

\sphinxstepscope


\chapter{Introduction to Solid Mechanics}
\label{\detokenize{ch/solids/intro:introduction-to-solid-mechanics}}\label{\detokenize{ch/solids/intro:solid-mechanics-intro}}\label{\detokenize{ch/solids/intro::doc}}
\sphinxstepscope


\chapter{Small displacement \sphinxhyphen{} statics}
\label{\detokenize{ch/solids/small-displacements-statics:small-displacement-statics}}\label{\detokenize{ch/solids/small-displacements-statics:solid-mechanics-intro-small-displacements-statics}}\label{\detokenize{ch/solids/small-displacements-statics::doc}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Labile \sphinxhyphen{} Undetermined.}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Isostatic \sphinxhyphen{} “determined”.}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Hyperstatic \sphinxhyphen{} “overdetermined”.}

\end{itemize}


\section{Linear isotropic elastic medium}
\label{\detokenize{ch/solids/small-displacements-statics:linear-isotropic-elastic-medium}}\label{\detokenize{ch/solids/small-displacements-statics:solid-mechanics-intro-small-displacements-statics-elastic-medium}}

\subsection{Constitutive equation}
\label{\detokenize{ch/solids/small-displacements-statics:constitutive-equation}}\label{\detokenize{ch/solids/small-displacements-statics:solid-mechanics-intro-small-displacements-statics-elastic-medium-constitutive-equation}}
\sphinxAtStartPar
An isotropic elastic medium has no prefereed orientation. The most general linear relation between stress tensor \(\symbf{\sigma}\) and strain tensor \(\symbf{\varepsilon}\), and temperature difference \(\Delta T\) w.r.t. a reference temperature, \(\Delta T := T - T_0\),
\begin{equation*}
\begin{split}\symbf{\sigma} = \mathbf{D} : \symbf{\varepsilon} - \symbf{\beta} \Delta T \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
for isotropic media involves the rank\sphinxhyphen{}\(2\) and rank\sphinxhyphen{}\(4\) isotropic tensors, see \DUrole{xref,std,std-ref}{rank\sphinxhyphen{}2\sphinxhyphen{}iso}, and \DUrole{xref,std,std-ref}{rank\sphinxhyphen{}4\sphinxhyphen{}iso}. Since stress tensor \(\symbf{\sigma}\) and strain tensor \(\symbf{\varepsilon}\) are symmetric the constitutive law for isotropic elastic media reads
\begin{equation}\label{equation:ch/solids/small-displacements-statics:eq:linear-isotropic-elastic}
\begin{split}\symbf{\sigma} = 2 \mu \symbf{\varepsilon} + \lambda \, \text{tr}(\symbf{\varepsilon}) \mathbb{I} - \beta \Delta T \mathbb{I} \ ,\end{split}
\end{equation}
\sphinxAtStartPar
being \(\mu\), \(\lambda\) the Lamé coefficients.

\sphinxAtStartPar
Decomposition of tensor in hydrostatic (proportional to \(\mathbb{I}\)) and deviatoric (traceless) parts reads
\begin{equation}\label{equation:ch/solids/small-displacements-statics:eq:linear-isotropic-elastic:iso-dev}
\begin{split}\symbf{\sigma} = \left( 2 \mu \symbf{\varepsilon} - \frac{2}{3} \mu \, \text{tr}(\varepsilon) \mathbb{I} \right) + \left( \lambda + \frac{2}{3} \mu \right)\text{tr}(\varepsilon) \mathbb{I} - \beta \Delta T \mathbb{I} \end{split}
\end{equation}
\sphinxAtStartPar
The expression of strain tensor \(\symbf{\varepsilon}\) as a function of stress tensor and temperature difference
\begin{equation*}
\begin{split}\symbf{\varepsilon} = \end{split}
\end{equation*}
\sphinxAtStartPar
can be easily evaluated, using the relation between the traces of the tensors
\subsubsection*{Different expression of constitutive laws, and sets of parameters.}

\sphinxAtStartPar
Remembering that \(\text{tr}(\mathbb{I}) = 3\) in the 3\sphinxhyphen{}dimensional space, evaluating the trace of the relation \eqref{equation:ch/solids/small-displacements-statics:eq:linear-isotropic-elastic} provides the relation between the traces of strain and stress tensors and the temeprature difference
\begin{equation*}
\begin{split}\text{tr} (\symbf{\sigma}) = \left( 2 \mu + 3 \lambda \right) \text{tr} (\symbf{\varepsilon}) - 3 \beta \Delta T \ , \end{split}
\end{equation*}
\sphinxAtStartPar
and thus
\begin{equation*}
\begin{split}\text{tr} (\symbf{\varepsilon}) = \frac{1}{ 2 \mu + 3 \lambda} \text{tr} (\symbf{\sigma}) + \frac{3 \beta}{ 2 \mu + 3 \lambda} \Delta T \ . \end{split}
\end{equation*}
\sphinxAtStartPar
Using the relation between traces, it’s possible to find \(\symbf{\varepsilon}\left(\symbf{\sigma}, \Delta T \right)\),
\begin{equation*}
\begin{split}\begin{aligned}
  \symbf{\varepsilon}
  & = \frac{1}{2 \mu} \symbf{\sigma} - \frac{\lambda}{2\mu} \text{tr}(\symbf{\varepsilon}) \mathbb{I} + \frac{\beta}{2 \mu} \Delta T \mathbb{I} = \\
  & = \frac{1}{2 \mu} \symbf{\sigma} - \frac{\lambda}{2\mu} \left[ \frac{1}{2 \mu + 3 \lambda} \text{tr}(\symbf{\sigma}) + \frac{3 \beta}{2 \mu + 3 \lambda} \Delta T \right] \mathbb{I} + \frac{\beta}{2 \mu} \Delta T \mathbb{I} = \\
  & = \frac{1}{2 \mu} \symbf{\sigma} - \frac{\lambda}{2\mu ( 2 \mu + 3 \lambda)} \text{tr}(\symbf{\sigma}) \mathbb{I} + \frac{1}{2 \mu}\left[ 1 - \frac{3 \lambda}{2 \mu + 3 \lambda} \right] \beta \Delta T \mathbb{I} = \\
  & = \frac{1}{2 \mu} \symbf{\sigma} - \frac{\lambda}{2\mu ( 2 \mu + 3 \lambda)} \text{tr}(\symbf{\sigma}) \mathbb{I} + \frac{1}{2 \mu + 3 \lambda}  \beta \Delta T \mathbb{I} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Modulo elastico.} Il modulo elastico \(E\) è definito dalla relazione
\begin{equation*}
\begin{split}\begin{aligned}
  \frac{1}{E} 
  & = \frac{1}{2 \mu} - \frac{\lambda}{2 \mu (2 \mu + 3 \lambda)} = \\
  & = \frac{1}{2 \mu} \frac{2 (\mu + \lambda)}{2 \mu + 3 \lambda} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
e quindi
\begin{equation*}
\begin{split}E = \frac{\mu (2 \mu + 3 \lambda)}{\mu + \lambda}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Modulo di Poisson.} Il modulo di Poisson \(\nu\) è definito dalla relazione
\begin{equation*}
\begin{split}\frac{\nu}{E} = \frac{\lambda}{2\mu (2 \mu + 3 \lambda)} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
e quindi
\begin{equation*}
\begin{split}\nu = \frac{\lambda}{2 (\mu + \lambda)}\end{split}
\end{equation*}\subsubsection*{Thermodynamics}

\sphinxAtStartPar
Helmholtz’s free energy is the thermodynamic potential \(F\) defined w.r.t. temperature \(T\) and generalized displacements \(\mathbf{X}_i\) as independet variables. Here \sphinxstylestrong{unit\sphinxhyphen{}volume} relation (Explain why! Link to general continuum mechanics, and equations in reference coordinates). Using difference of temperature \(\Delta T = T - T_0\) w.r.t. a reference temperature \(T_0\) instead of temperature \(T\), differential of Helmhtoltz’s free energy per unit volume for a linear elastic medium reads
\begin{equation*}
\begin{split}d\mathcal{F}(\varepsilon_{ij}, \Delta T) = - \mathcal{S} d \Delta T + \sigma_{ij} d \varepsilon_{ij} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
so that
\begin{equation*}
\begin{split}
\sigma_{ij} = \left( \frac{\partial \mathcal{F}}{\partial \varepsilon_{ij}} \right)_{\mathcal{S}}
\qquad , \qquad
\mathcal{S} = - \left( \frac{\partial \mathcal{F}}{\partial T} \right)_{\varepsilon_{ij}} \ .
\end{split}
\end{equation*}
\sphinxAtStartPar
Using the constitutive law \eqref{equation:ch/solids/small-displacements-statics:eq:linear-isotropic-elastic} for a linear isotropic elastic medium, here written in Cartesian coordinates as
\begin{equation*}
\begin{split}\sigma_{ij} = 2 \mu \varepsilon_{ij} + \lambda \varepsilon_{kk} \delta_{ij} - \beta \Delta T \delta_{ij} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
integration w.r.t. \(\varepsilon_{ij}\) gives
\begin{equation*}
\begin{split}\begin{aligned}
  \mathcal{F}(\varepsilon_{ij}, \Delta T) 
  & = \frac{1}{2} \left( 2  \mu \varepsilon_{ij} \varepsilon_{ij} + \lambda \varepsilon_{kk} \varepsilon_{ll} \right) - \beta \Delta T \varepsilon_{ll} + \mathcal{F}(0, \Delta T) = \\
  & = \frac{1}{2} \left( 2 \mu \symbf{\varepsilon} : \symbf{\varepsilon} + \lambda \left( \text{tr}(\symbf{\varepsilon}) \right)^2 \right) - \beta \Delta T \text{tr}(\symbf{\varepsilon}) + \mathcal{F}(0, \Delta T) \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
being \(\mathcal{F}(0, \Delta T) = F(\Delta T)\) a function of \(\Delta T\) appearing from integration in \(\varepsilon_{ij}\). If you don’t trust this, try do evaluate the partial derivative w.r.t. the components of the strain tensor of the last relation.

\sphinxAtStartPar
\sphinxstylestrong{Entropy.} Entropy is the parital derivative w.r.t. \(T\) of Helmholtz’s free energy and, assuming constant parameters, its expression reads
\begin{equation*}
\begin{split}\begin{aligned}
  \mathcal{S}(\varepsilon_{ij}, \Delta T) 
  = - \left( \frac{\partial \mathcal{F}}{\partial T} \right)_{\varepsilon_{ij}} 
  = \beta \varepsilon_{ll} - F'(\Delta T) \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Heat coefficients.} Heat coefficient at constant strain per unit\sphinxhyphen{}volume reads
\begin{equation*}
\begin{split}C_{\varepsilon_{ij}} := T \left( \frac{\partial \mathcal{S}}{\partial T} \right)_{\varepsilon_{ij}} = - (T_0 + \Delta T) F''(\Delta T) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Assuming that heat coefficient \(C_{\varepsilon_{ij}}\) is independent from \(T\), integration in \(\Delta T\) gives
\begin{equation*}
\begin{split}C_{\varepsilon_{ij}} \ln \left( 1 + \frac{\Delta T}{T_0} \right) = - F'(\Delta T) + F'(0) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and thus an expression for \(F'(\Delta T)\)
\begin{equation*}
\begin{split}F'(\Delta T) = - C_{\varepsilon_{ij}} \ln \left( 1 + \frac{\Delta T}{T_0} \right) + F'(0) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
to be inserted in the expression of entropy
\begin{equation*}
\begin{split}\mathcal{S}(\varepsilon_{ij}, \Delta T) = \beta \varepsilon_{ll} + C_{\varepsilon_{ij}} \ln \left( 1 + \frac{\Delta T}{T_0} \right) - F'(0) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and \(-F'(0) = \mathcal{S}_0\) can be recognized as the entropy per unit volume in the reference condition with \(\varepsilon_{ij} = 0\), \(\Delta T = 0\). The differential of the last expression reads
\begin{equation*}
\begin{split}d \mathcal{S}
 = \beta d \varepsilon_{ll} + \frac{C_{\varepsilon_{ij}}}{T_0} \frac{1}{1 + \frac{\Delta T}{T_0}} \, d T  
 = \beta d \varepsilon_{ll} + \frac{C_{\varepsilon_{ij}}}{T}\, d T  
\end{split}
\end{equation*}
\sphinxAtStartPar
or
\begin{equation*}
\begin{split}dT = \frac{T}{C_{\varepsilon_{ij}}} d \mathcal{S} - \frac{\beta T}{C_{\varepsilon_{ij}}} \, d \varepsilon_{ll}\end{split}
\end{equation*}
\sphinxAtStartPar
Furhter integration in \(\Delta T\) of
\begin{equation*}
\begin{split}F'(\Delta T) = - C_{\varepsilon_{ij}} \ln \left( 1 + \frac{\Delta T}{T_0} \right) - \mathcal{S}_0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
gives and expression of funtion \(F(\Delta T)\),
\begin{equation*}
\begin{split}F(\Delta T) - F(0) = -C_{\varepsilon_{ij}} \left[ (T_0 + \Delta T) \ln \left( 1 + \frac{\Delta T}{T_0} \right) - \Delta T \right] - \mathcal{S}_0 \Delta T \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
that can be used int he expression of Helmholtz free energy, as an example, as show later.

\sphinxAtStartPar
\sphinxstylestrong{Internal energy.} The relation between the internal energy and Hemlholtz free energy \(\mathcal{F} = \mathcal{E} - T \mathcal{S}\) allows to find the expression of the internal energy per unit volume of an elastic linear isotropic media,
\begin{equation*}
\begin{split}\begin{aligned}
\mathcal{E} 
& = \mathcal{F} + T \mathcal{S} = \\
& = \mu \varepsilon_{ij} \varepsilon_{ij} + \frac{\lambda}{2} \left(  \varepsilon_{kk} \right)^2 - \beta \Delta T \varepsilon_{kk} + F(0) -C_{\varepsilon_{ij}} \left[ (T_0 + \Delta T) \ln \left( 1 + \frac{\Delta T}{T_0} \right) - \Delta T \right] \\
& \quad  - \mathcal{S}_0 \Delta T + (T_0 + \Delta T) \left( \beta \varepsilon_{ll} + C_{\varepsilon_{ij}} \ln \left( 1 + \frac{\Delta T}{T_0} \right) + \mathcal{S}_0 \right) = \\
& = \mu \varepsilon_{ij} \varepsilon_{ij} + \frac{\lambda}{2} \left(  \varepsilon_{kk} \right)^2 + \beta T_0 \varepsilon_{kk} + C_{\varepsilon_{ij}} \Delta T + F(0) + T_0 \mathcal{S}_0  \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that the reference internal energy and reference Helmholtz free energy can be recognized as
\begin{equation*}
\begin{split}\mathcal{F}_0 = F(0) \qquad , \qquad \mathcal{E}_0 = \mathcal{F}_0 + T_0 \mathcal{S}_0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
In order to write the differential of the internal energy w.r.t. its natural independent variables \(\mathcal{E}(\varepsilon_{ij}, \mathcal{S})\), the temperature difference must be written as a function of strain and entropy. Using relation \sphinxstylestrong{todo}, and performing derivatives of the composite funciton \(\mathcal{E}(\varepsilon_{ij}, \Delta T(\varepsilon_{ij}, \mathcal{S}))\)
\begin{equation*}
\begin{split}\begin{aligned}
  d \mathcal{E} 
  & = \left( \frac{\partial \mathcal{E}}{\partial \varepsilon_{ij}} \right)_{\Delta T} d \varepsilon_{ij} + \left( \frac{\partial \mathcal{E}}{\partial \Delta T} \right)_{\varepsilon_{ij}} \left[ \left( \frac{\partial \Delta T}{\partial \varepsilon_{ij}} \right)_{\mathcal{S}} d \varepsilon_{ij} + \left( \frac{\partial \Delta T}{\partial \mathcal{S}} \right)_{\varepsilon_{ij}} d \mathcal{S} \right] = \\
  & = \left( 2 \mu \varepsilon_{ij} + \lambda \varepsilon_{kk} \delta_{ij} + \beta T_0 \delta_{ij} \right) d \varepsilon_{ij} + 
   C_{\varepsilon_{ij}} \left[ -\frac{\beta T}{C_{\varepsilon_{ij}}} \delta_{ij} \, d \varepsilon_{ij} + \frac{T}{C_{\varepsilon_{ij}}} \, d \mathcal{S} \right] = \\
  & = \left( 2 \mu \varepsilon_{ij} + \lambda \varepsilon_{kk} \delta_{ij} - \beta \Delta T \delta_{ij} \right) d \varepsilon_{ij} + T \, d \mathcal{S} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
i.e. we found what we should have expected, i.e.
\begin{equation*}
\begin{split}d \mathcal{E} = \sigma_{ij} \, d \varepsilon_{ij} + T \, d\mathcal{S} \ , \end{split}
\end{equation*}
\sphinxAtStartPar
and thus
\begin{equation*}
\begin{split}\begin{aligned}
\sigma_{ij}
 & = \left( \frac{\partial \mathcal{F}}{\partial \varepsilon_{ij}} \right)_{T}
   = \left( \frac{\partial \mathcal{E}}{\partial \varepsilon_{ij}} \right)_{\mathcal{S}} \\
 T & = \left( \frac{\partial \mathcal{E}}{\partial \mathcal{S}} \right)_{\varepsilon_{ij}}\\
 \mathcal{S} & = - \left( \frac{\partial \mathcal{F}}{\partial T} \right)_{\varepsilon_{ij}}\\
\end{aligned}\end{split}
\end{equation*}\subsubsection*{Isothermal and isentropic elastic coefficients}

\sphinxAtStartPar
Assuming small enough \(\Delta T = T - T_0\) so that linear approximation of the relation between entropy, temperature and strain holds,
\begin{equation*}
\begin{split}\Delta \mathcal{S} = \beta \, \varepsilon_{ll} + \frac{C_{\varepsilon_{ij}}}{T_0} \Delta T \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
it’s possible to write the stress tensor as a function of strain and entropy
\begin{equation*}
\begin{split}\begin{aligned}
  \sigma_{ij} 
  & = 2 \mu \varepsilon_{ij} + \lambda \varepsilon_{ll} \delta_{ij} - \beta \Delta T \delta_{ij} = \\
  & = 2 \mu \varepsilon_{ij} + \lambda \varepsilon_{ll} \delta_{ij} - \beta \left[ \frac{T_0}{C_{\varepsilon_{ij}}} \Delta \mathcal{S} - \frac{T_0}{C_{\varepsilon_{ij}}} \beta \, \varepsilon_{ll}  \right] \delta_{ij} = \\
  & = 2 \mu \varepsilon_{ij} + \left( \lambda + \frac{\beta^2 T_0}{C_{\varepsilon_{ij}}} \right) \varepsilon_{ll} \delta_{ij} - \beta \frac{T_0}{C_{\varepsilon_{ij}}} \Delta \mathcal{S} = \\
  & = 2 \mu_s \varepsilon_{ij} + \lambda_s \varepsilon_{ll} \delta_{ij} - \beta \frac{T_0}{C_{\varepsilon_{ij}}} \Delta \mathcal{S} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having defined Lamé coefficients in isentropic conditions as functions of the cofficients in isothermal conditions,
\begin{equation*}
\begin{split}\begin{aligned}
  \lambda_s & = \lambda + \frac{\beta^2 T_0}{C_{\varepsilon_{ij}}} \\
      \mu_s & = \mu
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Elastic modulus and Poisson ratio.} Starting from the relations
\begin{equation*}
\begin{split}\begin{aligned}
  E & = \frac{\mu (2 \mu + 3 \lambda)}{\mu + \lambda} \\
  \frac{E}{\nu} & = \frac{2 \mu (2 \mu + 3 \lambda)}{\lambda} \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}G E + \lambda E = 2 G^2 + 3 G \lambda\end{split}
\end{equation*}\begin{equation*}
\begin{split}\lambda = \frac{G (E - 2 G)}{ 3G - E }\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \nu
  & = \frac{E \lambda}{2G(2G+3 \lambda)} = \\
  & = \frac{\lambda}{2G(2G+3 \lambda)} \frac{G (2G + 3\lambda)}{G + \lambda} = \\
  & = \frac{\lambda}{2(G + \lambda)} = \\ 
  & = \frac{G(E-2G)}{3G - E} \frac{1}{2 \left( G + \frac{G(E-2G)}{3G-E} \right)} = \\
  & = \frac{G}{2G} \frac{E-2G}{3G - E} \frac{3G - E}{3G - E + E - 2G } = \\
  & = \frac{1}{2} \frac{E - 2G}{G} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that
\begin{equation*}
\begin{split}\nu = \frac{E - 2G}{2G} \qquad , \qquad G = \frac{E}{2(1+\nu)}\end{split}
\end{equation*}

\subsubsection*{Heat capacity, thermal expansion coefficients, compressibility coefficients}

\sphinxAtStartPar
\sphinxstylestrong{Thermal expansion coefficient} reads
\begin{equation*}
\begin{split}\alpha_x := \frac{1}{V} \left( \frac{\partial V}{\partial T}\right)_x\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\dfrac{dV}{V} = d \text{tr}(\symbf{\varepsilon})\) for small displacement and strain regime. At constant strain, \(d \sigma_{ij} = 0\),
\begin{equation*}
\begin{split}
  \alpha_{\sigma} = \left( \dfrac{\partial \varepsilon_{ll}}{\partial T} \right)_{\sigma}
\end{split}
\end{equation*}\subsubsection*{Some algebra}
\begin{equation*}
\begin{split}\begin{aligned}
  & = \frac{3 \beta}{2 \mu + 3 \lambda} = \\
  & = 3 \beta \frac{2 G \nu }{E \lambda} = \\
  & = 3 \beta \frac{\nu }{(1+ \nu) \lambda} = \\
  & = 3 \beta \frac{\nu }{(1+ \nu)} \frac{3G-E}{G(E-2G)} = \\
  & = 3 \beta \frac{\nu }{(1+ \nu)} \frac{3-2(1+\nu)}{G\left(2(1+\nu)  -2 \right)} = \\
  & = 3 \frac{\beta}{2G} \frac{\nu }{(1+ \nu)} \frac{1-2\nu}{\nu} = \\
  & = 3 \frac{\beta}{E} (1 - 2 \nu)  \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that
\begin{equation*}
\begin{split}\beta = K \alpha_{\sigma} = \left( \frac{2}{3} \mu +  \lambda \right) \, \alpha_{\sigma} = \frac{E}{3(1-2\nu)} \, \alpha_{\sigma} \end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Heat capacity.} The heat capacity at constant strain \(C_{\varepsilon_{ij}}\) has been assumed to be constant (or just independent from temperature). Entropy can be written as functions of strain and temperature or \sphinxhyphen{} exploiting the relation between traces of tensors \sphinxhyphen{} stress and temperature
\begin{equation*}
\begin{split}\begin{aligned}
  \mathcal{S} - \mathcal{S}_0
  & = \beta \varepsilon_{ll} + C_{\varepsilon_{ij}} \ln \left( 1 + \frac{\Delta T}{T_0} \right) \\
  & = \beta \left( \frac{1}{2\mu+3\lambda} \sigma_{ll} + \alpha_{\sigma} \Delta T \right) + C_{\varepsilon_{ij}} \ln \left( 1 + \frac{\Delta T}{T_0} \right) \\
  & = \beta \left( \frac{1}{3 \, K} \sigma_{ll} + \alpha_{\sigma} \Delta T \right) + C_{\varepsilon_{ij}} \ln \left( 1 + \frac{\Delta T}{T_0} \right) \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus, constaint strain heat capacity per unit volume reads
\begin{equation*}
\begin{split}C_{\varepsilon_{ij}} := T \left( \frac{\partial \mathcal{S}}{\partial T} \right)_{\varepsilon} = C_{\varepsilon_{ij}} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
as defined above, whilte constant stress heat capacity per unit volume reads
\begin{equation*}
\begin{split}\begin{aligned}
  C_{\sigma_{ij}}
  & := T \left( \frac{\partial \mathcal{S}}{\partial T} \right)_{\sigma} = \\
  &  = T \left( \beta \alpha_{\sigma} + C_{\varepsilon_{ij}} \frac{1}{T_0} \frac{1}{1 + \frac{\Delta T}{T_0}} \right) \\
  &  = T K \alpha^2_{\sigma} + C_{\varepsilon_{ij}} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Compressibility coefficients.} \sphinxstylestrong{todo} \sphinxstyleemphasis{check: Below, \(T\) or \(T_0\)? It should be a minor change, since we’re assuming small \(\Delta T\) so that linearized constitutive equation holds?}
\begin{equation*}
\begin{split}\begin{aligned}
  K   & = \frac{2}{3} \mu + \lambda \\
  K_s & = \frac{2}{3} \mu_s + \lambda_s = \frac{2}{3} \mu + \lambda + \frac{\beta^2 T}{C_{\varepsilon_{ij}}} = K + \frac{\beta^2 T}{C_{\varepsilon_{ij}}} = K + \frac{K^2 \alpha^2_{\sigma} T}{C_{\varepsilon}}
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  K_s 
  & = K \left( 1 + \frac{\alpha^2 K T}{C_{\varepsilon}} \right) \\
 \rightarrow \quad  & \frac{1}{K_s} = \frac{1}{K} \frac{C_{\varepsilon}}{C_{\sigma}} \\
 \rightarrow \quad  & \frac{1}{K_s} = \frac{1}{K} \frac{C_{\sigma} - \alpha_{\sigma}^2 K T}{C_{\sigma}} \\
 \rightarrow \quad  & \frac{1}{K_s} = \frac{1}{K} - \frac{\alpha_{\sigma}^2 T}{C_{\sigma}} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Elastic modulus and Poisson ratio.}
\begin{equation*}
\begin{split}
 E_s = \frac{E}{1 - E \, \dfrac{\alpha^2_\sigma T}{9 C_\sigma}}
 \qquad , \qquad
 \nu_s = \frac{\nu + E \, \dfrac{\alpha^2_\sigma T}{9 C_\sigma}}{1 - E \, \dfrac{\alpha^2_\sigma T}{9 C_\sigma}}
\end{split}
\end{equation*}\subsubsection*{Some algebra}
\begin{equation*}
\begin{split}\begin{aligned}
  K 
  & = \lambda + \frac{2}{3} G = \\
  & = \frac{GE - 2G^2}{3G-E} + \frac{2}{3} G = \\
  & = G \frac{3 E - 6 G + 6 G - 2 E}{3(3 G -  E)} = \frac{E G}{3 (3 G - E)}
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}E = \frac{9 G K}{ 3 K + G } = \frac{1}{ \frac{1}{3 G} + \frac{1}{9 K}} \end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  E_s 
  & = \frac{1}{ \dfrac{1}{3 G_s} + \dfrac{1}{9 K_s}} = \\
  & = \frac{1}{\dfrac{1}{3 G} + \dfrac{1}{9 K} - \dfrac{\alpha^2_\sigma T}{9 C_\sigma}} = \\
  & = \frac{\left(\dfrac{1}{3 G} + \dfrac{1}{9 K}\right)^{-1}}{\left(\dfrac{1}{3 G} + \dfrac{1}{9 K} - \dfrac{\alpha^2_\sigma T}{9 C_\sigma}\right)\left(\dfrac{1}{3 G} + \dfrac{1}{9 K}\right)^{-1}} = \\
  & = \frac{E}{1 - E \, \dfrac{\alpha^2_\sigma T}{9 C_\sigma}} = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Fix admonition reference

\begin{sphinxadmonition}{note}{Isotropic tensor}

\sphinxAtStartPar
An isotropic tensor is a tensor whose components do not change after a rotation of the vector basis. \sphinxstylestrong{todo} \sphinxstyleemphasis{Examples,…}
\end{sphinxadmonition}

\begin{sphinxadmonition}{note}{Rank\sphinxhyphen{}\protect\(2\protect\) isotropic tensor}

\sphinxAtStartPar
The most general expression of a rank\sphinxhyphen{}\(2\) isotropic tensor is proportional to the rank\sphinxhyphen{}\(2\) identity tensor, and can be written in a Cartesina basis using the Kroeneker delta,
\begin{equation*}
\begin{split}a \mathbf{I} = a \delta_{ij} \hat{e}_i \otimes \hat{e}_j \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{Proof}
\end{sphinxadmonition}

\begin{sphinxadmonition}{note}{Rank\sphinxhyphen{}\protect\(4\protect\) isotropic tensor}

\sphinxAtStartPar
The most general expression of a rank\sphinxhyphen{}\(4\) isotropic tensor can be written using a Cartesian basis as
\begin{equation*}
\begin{split}\mathbf{D} = D_{ijkl} \hat{e}_i \otimes \hat{e}_j \otimes \hat{e}_k \otimes \hat{e}_l \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
where
\begin{equation*}
\begin{split}D_{ijkl} = a \delta_{ij} \delta_{kl} + b \delta_{ik} \delta_{jl} + c \delta_{il}\delta_{jk} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
i.e. depends on three possible combinations of rank\sphinxhyphen{}2 identity tensor, with 3 scalar parameters, \(a\), \(b\), \(c\). In isotropic relation between symmetric tensors, \(A_{ij} = A_{ji}\), \(B_{kl} = B_{lk}\) only two parameters are enough since
\begin{equation*}
\begin{split}\begin{aligned}
  A_{ij} 
  & = D_{ijkl} B_{kl} = \\
  & = \left( a \delta_{ij} \delta_{kl} + b \delta_{ik} \delta_{jl} + c \delta_{il}\delta_{jk} \right) B_{kl} = \\
  & = a \delta_{ij} B_{ll} + b B_{ij} + c  B_{ji} =  & (1) \\
  & = a \delta_{ij} B_{ll} + (b+c) B_{ij} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having used (1) the symmetry of tensor \(\mathbf{B}\), \(B_{ji} = B_{ij}\).

\sphinxAtStartPar
\sphinxstylestrong{References.}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://farside.ph.utexas.edu/teaching/336L/Fluid/node252.html}{Fluid Mechanics, R. Fitzpatrick, University of Texas, Austin}

\item {} 
\sphinxAtStartPar
P.G. Hodge, \sphinxstyleemphasis{On Isotropic Cartesian Tensors}, 1961, The American Mathematical Monthly

\end{itemize}
\end{sphinxadmonition}


\section{Beam models}
\label{\detokenize{ch/solids/small-displacements-statics:beam-models}}\label{\detokenize{ch/solids/small-displacements-statics:solid-mechanics-intro-small-displacements-statics-beam}}

\section{Beam structures}
\label{\detokenize{ch/solids/small-displacements-statics:beam-structures}}\label{\detokenize{ch/solids/small-displacements-statics:solid-mechanics-intro-small-displacements-statics-beam-structures}}
\sphinxstepscope


\chapter{Waves in linear elastic homogeneous isotropic media}
\label{\detokenize{ch/solids/small-displacements-waves:waves-in-linear-elastic-homogeneous-isotropic-media}}\label{\detokenize{ch/solids/small-displacements-waves:solid-mechanics-intro-small-displacements-waves}}\label{\detokenize{ch/solids/small-displacements-waves::doc}}

\section{Navier\sphinxhyphen{}Cauchy equation: displacement formulation of the momentum equation}
\label{\detokenize{ch/solids/small-displacements-waves:navier-cauchy-equation-displacement-formulation-of-the-momentum-equation}}
\sphinxAtStartPar
Momentum balance equation in differential form for continuous media in the small\sphinxhyphen{}displacement regime
\begin{equation*}
\begin{split}\rho_0 \, \partial_{tt} \mathbf{s} = \rho_0 \, \mathbf{g} + \nabla \cdot \boldsymbol{\sigma} \ .\end{split}
\end{equation*}\begin{itemize}
\item {} 
\sphinxAtStartPar
Introducing the constitutive equation for linear elastic homogeneous isotropic media,
\begin{equation*}
\begin{split}\boldsymbol{\sigma} = 2 \mu \, \boldsymbol{\varepsilon} + \lambda \, \text{tr} \left( \boldsymbol{\varepsilon} \right) \mathbf{I} \ ,\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
using the definition of the strain tensor

\end{itemize}
\begin{equation*}
\begin{split}\boldsymbol{\varepsilon} = \dfrac{1}{2} \left[ \nabla \mathbf{s} + \nabla^T \mathbf{s} \right] \ ,\end{split}
\end{equation*}\begin{itemize}
\item {} 
\sphinxAtStartPar
and under the assumption of no volume force \(\mathbf{g} = \mathbf{0}\),

\end{itemize}

\sphinxAtStartPar
the momentum equation becomes
\begin{equation*}
\begin{split}\begin{aligned}
  \rho_0 \partial_{tt} \mathbf{s} & = \mu \nabla^2 \mathbf{s} + \left( \mu +\lambda \right) \nabla \nabla \cdot \mathbf{s} \ ,
\end{aligned}\end{split}
\end{equation*}

\section{Helmholtz decomposition and sum of waves equation for \protect\(p\protect\) and \protect\(s\protect\) waves}
\label{\detokenize{ch/solids/small-displacements-waves:helmholtz-decomposition-and-sum-of-waves-equation-for-p-and-s-waves}}
\sphinxAtStartPar
Displacement field can be written using \sphinxhref{https://en.wikipedia.org/wiki/Helmholtz\_decomposition}{Helmholtz decomposition} as the sum of a potential \(\mathbf{s}_p = \nabla \phi\) (s.t. \(\nabla \times \nabla \phi = \mathbf{0}\)) and a divergence\sphinxhyphen{}free \(\mathbf{s}_s = \nabla \times \mathbf{a}\) (s.t. \(\nabla \cdot \nabla \times \mathbf{a} = \mathbf{0}\)) part,
\begin{equation*}
\begin{split}\mathbf{s} = \mathbf{s}_p + \mathbf{s}_s = \nabla \phi + \nabla \times \mathbf{a} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Introducing the last expression in the momentum equation, using vector identity
\begin{equation*}
\begin{split}\nabla^2 \mathbf{v} = \nabla \nabla \cdot \mathbf{v} - \nabla \times \nabla \times \mathbf{v} \ , \end{split}
\end{equation*}
\sphinxAtStartPar
the equation can be written as
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{0} 
  & = \rho_0 \partial_{tt} \nabla \phi - (2 \mu + \lambda) \nabla^2 \nabla \phi + \rho_0 \partial_{tt} \nabla \times \mathbf{a} + \mu \nabla^2 \nabla \times \mathbf{a} = \\
  & = \rho_0 \partial_{tt} \mathbf{s}_p - (2 \mu + \lambda) \nabla^2 \mathbf{s}_p + \rho_0 \partial_{tt} \mathbf{s}_s - \mu \nabla^2 \mathbf{s}_s \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
i.e. as the “sum of two wave equations” for the potential part \(\mathbf{s}_p\) and the divergence\sphinxhyphen{}free part \(\mathbf{s}_s\) of the displacement. Speed of propagation of \(p\)\sphinxhyphen{} and \(s\)\sphinxhyphen{}displacement read
\begin{equation*}
\begin{split}c_p = \sqrt{\dfrac{2 \mu + \lambda}{\rho_0}} \qquad , \qquad c_s = \sqrt{\dfrac{\mu}{\rho_0}} \ .\end{split}
\end{equation*}

\section{Fourier decomposition: \protect\(p\protect\) is longitudinal, \protect\(s\protect\) is transverse}
\label{\detokenize{ch/solids/small-displacements-waves:fourier-decomposition-p-is-longitudinal-s-is-transverse}}
\sphinxAtStartPar
Using \sphinxstylestrong{Fourier decomposition} of fields as sum of harmonic plane waves,
\begin{equation*}
\begin{split}\mathbf{s}(\mathbf{r},t) = \sum_{\mathbf{k},\omega} \mathbf{s}_{\mathbf{k},\omega} e^{i\left( \mathbf{k} \cdot \mathbf{r}- \omega t \right)} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
it’s immediate to prove that the potential part can be associated to a longitudinal perturbation (i.e. with displacement in the same direction of the wave vector \(\mathbf{k}\), representing the direction of propagation of  the perturbation, while the divergence\sphinxhyphen{}free part can be associated to a transverse perturnation (i.e. with displacement orthogonal to the wave vector \(\mathbf{k}\)). Helmholtz’s decomposition of the field in Fourier domain reads
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{s}(\mathbf{r},t) 
  & = \sum_{\mathbf{k},\omega} \mathbf{s}_{\mathbf{k},\omega} e^{i\left( \mathbf{k} \cdot \mathbf{r}- \omega t \right)} = \\
  & = \sum_{\mathbf{k},\omega} \left( \mathbf{s}^p_{\mathbf{k},\omega} + \mathbf{s}^s_{\mathbf{k}, \omega} \right) e^{i\left( \mathbf{k} \cdot \mathbf{r}- \omega t \right)} = \\
  & = \sum_{\mathbf{k},\omega} \left( i \, \mathbf{k} \phi_{\mathbf{k},\omega} + i \, \mathbf{k} \times \mathbf{a}_{\mathbf{k}, \omega} \right) e^{i\left( \mathbf{k} \cdot \mathbf{r}- \omega t \right)} = \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
For each individual harmonic contribution, the potential part is thus proportional, i.e. aligned, to wave vector \(\mathbf{k}\),
\begin{equation*}
\begin{split}\mathbf{s}^p_{\mathbf{k},\omega} = i \,\mathbf{k} \phi_{\mathbf{k},\omega}  \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
while the divergence\sphinxhyphen{}free is orthogonal, and thus transverse, w.r.t. the direction of wave propagation,
\begin{equation*}
\begin{split}\mathbf{k} \cdot \mathbf{s}^s_{\mathbf{k},\omega} = i \, \mathbf{k} \times  \left( \mathbf{k} \times \mathbf{a}_{\mathbf{k}, \omega} \right) = \mathbf{0} \ .\end{split}
\end{equation*}
\sphinxstepscope


\chapter{Modal methods for structural problems}
\label{\detokenize{ch/solids/small-displacements-numerics:modal-methods-for-structural-problems}}\label{\detokenize{ch/solids/small-displacements-numerics:solid-mechanics-intro-small-displacements-numerics}}\label{\detokenize{ch/solids/small-displacements-numerics::doc}}\begin{equation*}
\begin{split}\mathbf{M} \ddot{\mathbf{u}} + \mathbf{K} \mathbf{u} = \mathbf{f} \ .\end{split}
\end{equation*}

\section{No free rigid motion}
\label{\detokenize{ch/solids/small-displacements-numerics:no-free-rigid-motion}}
\sphinxAtStartPar
If a structure has no free rigid motion, the stiffness matrix of mechanical systems is symmetric \sphinxstylestrong{definite positive}.

\sphinxAtStartPar
\sphinxstylestrong{Spectral decomposition of the problem.}
\begin{equation*}
\begin{split}\left[ s_i^2 \mathbf{M} + \mathbf{K} \right] \hat{\mathbf{u}}_i = \mathbf{0} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
or in index and matrix form
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = s_i^2 M_{jk} U_{ki} + K_{jk} U_{ki} = \\
    & = \mathbf{M} \mathbf{U} \mathbf{S}^2 + \mathbf{K} \mathbf{U} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
with the diagonal matrix \(\mathbf{S}\) collecting the eigenvalues,
\begin{equation*}
\begin{split}\mathbf{S} = \text{diag} \left\{ s_i \right\} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Properties.} For eigenvectors with different eigenvalues,
\begin{equation*}
\begin{split}\begin{aligned}
  \hat{\mathbf{u}}_j^* \mathbf{M} \hat{\mathbf{u}}_i = 0 \qquad , \qquad
  \hat{\mathbf{u}}_j^* \mathbf{K} \hat{\mathbf{u}}_i = 0 \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Nodal and modal unknowns.} The nodal vector can be written as a combination of modes, being \(\mathbf{q}\) the vector of modal amplitudes,
\begin{equation*}
\begin{split}\mathbf{u} = \mathbf{U} \mathbf{q} = \left[ \hat{\mathbf{u}}_1 | \dots | \hat{\mathbf{u}}_N \right] \mathbf{q} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Laplace domain.} In Laplace domain
\begin{equation*}
\begin{split}\begin{aligned}
  \left[ s^2 \mathbf{U}^* \mathbf{M} \mathbf{U} + \mathbf{U}^* \mathbf{K} \mathbf{U}\right] \mathbf{q}(s) & = \mathbf{U}^* \mathbf{f}(s) \\
  \text{diag}\left[ s^2 m_i + k_i \right] \mathbf{q}(s) & = \mathbf{U}^* \mathbf{f}(s) \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Modal damping} Adding modal damping, with simultaneous diagonalization with mass and stiffness matrices,
\begin{equation*}
\begin{split}
  \text{diag}\left[ s^2 m_i + s c_i + k_i \right] \mathbf{q}(s) & = \mathbf{U}^* \mathbf{f}(s) \\
 \mathbf{q}(s) & = \text{diag}\left[ \frac{1}{m_i ( s^2 + 2 \xi_i \omega_i s + \omega^2_i )} \right]\mathbf{U}^* \mathbf{f}(s) \ .
\end{split}
\end{equation*}
\sphinxAtStartPar
The original equation becomes
\begin{equation*}
\begin{split}\left[s^2 \mathbf{M} + s \mathbf{C} + \mathbf{K} \right] \mathbf{u} = \mathbf{f} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{M} & = \mathbf{U} \text{diag}\left\{ m_i \right\} \mathbf{U}^* \\
  \mathbf{C} & = \mathbf{U} \text{diag}\left\{ c_i \right\} \mathbf{U}^* \\
  \mathbf{K} & = \mathbf{U} \text{diag}\left\{ k_i \right\} \mathbf{U}^* \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and the eigenproblem reads
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{0} & = \left[ s_i^2 \mathbf{M} + s_i \mathbf{C} + \mathbf{K} \right] \hat{\mathbf{u}}_i \\
  \mathbf{0} & = \mathbf{M} \mathbf{U} \mathbf{S}^2 + \mathbf{C} \mathbf{U} \mathbf{S} + \mathbf{K} \mathbf{U} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Nodal vector.} Nodal vector thus reads
\begin{equation*}
\begin{split}\mathbf{u}(s) = \mathbf{U} \mathbf{q}(s) = \mathbf{U} \text{diag}\left[ \frac{1}{m_i ( s^2 + 2 \xi_i \omega_i s + \omega^2_i )} \right]\mathbf{U}^* \mathbf{f}(s) \end{split}
\end{equation*}
\sphinxAtStartPar
and the internal forces usually derived from a manipulation of the term \(\mathbf{K} \mathbf{u}(s)\),
\begin{equation*}
\begin{split}\mathbf{K} \mathbf{u}(s) = \mathbf{K} \mathbf{U} \text{diag}\left[ \frac{1}{m_i ( s^2 + 2 \xi_i \omega_i s + \omega^2_i )} \right]\mathbf{U}^* \mathbf{f}(s) \ .\end{split}
\end{equation*}

\subsection{Dimension reduction}
\label{\detokenize{ch/solids/small-displacements-numerics:dimension-reduction}}
\sphinxAtStartPar
Modal unknowns can usually partitioned in slow (dynamical, resolved) and fast modes (with natural frequencies well above the frequency content of the forcing, and the dynamics of the system; can be treated as static modes),
\begin{equation*}
\begin{split}\mathbf{q} = \begin{bmatrix} \mathbf{q}_s \\ \mathbf{q}_f \end{bmatrix} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the sum of their contributions give the nodal unknown,
\begin{equation*}
\begin{split}\mathbf{u} = \mathbf{U} \mathbf{q} = \begin{bmatrix} \mathbf{U}_s & \mathbf{U}_f \end{bmatrix} \begin{bmatrix} \mathbf{q}_s \\ \mathbf{q}_f \end{bmatrix} = \mathbf{U}_s \mathbf{q}_s + \mathbf{U}_f \mathbf{q}_f \ .\end{split}
\end{equation*}

\subsubsection{Truncation and direct recovery of loads}
\label{\detokenize{ch/solids/small-displacements-numerics:truncation-and-direct-recovery-of-loads}}\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{u} 
  & = \mathbf{U}_s \text{diag}\left[ \frac{1}{m_s ( s^2 + 2 \xi_s \omega_s s + \omega^2_s )} \right] \mathbf{U}_s^* \mathbf{f} 
    + \mathbf{U}_f \text{diag}\left[ \frac{1}{m_f ( s^2 + 2 \xi_f \omega_f s + \omega^2_f )} \right] \mathbf{U}_f^* \mathbf{f}
\end{aligned}\end{split}
\end{equation*}

\subsubsection{Mode acceleration and static recovery of fast modes}
\label{\detokenize{ch/solids/small-displacements-numerics:mode-acceleration-and-static-recovery-of-fast-modes}}
\sphinxAtStartPar
Static approximation of fast modes gives
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{u} 
  & = \mathbf{U}_s \text{diag}\left[ \frac{1}{m_s ( s^2 + 2 \xi_s \omega_s s + \omega^2_s )} \right] \mathbf{U}_s^* \mathbf{f} 
    + \mathbf{U}_f \text{diag}\left[ \frac{1}{m_f ( s^2 + 2 \xi_f \omega_f s + \omega^2_f )} \right] \mathbf{U}_f^* \mathbf{f} = \\
  & = \mathbf{U}_s \text{diag}\left[ \frac{1}{m_s ( s^2 + 2 \xi_s \omega_s s + \omega^2_s )} \right] \mathbf{U}_s^* \mathbf{f} 
    + \mathbf{U}_f \text{diag}\left[ \frac{1}{m_f \omega^2_f } \right] \mathbf{U}_f^* \mathbf{f}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and adding and subtracting the static response of the slow modes,
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{u} 
  & = \mathbf{U}_s \text{diag}\left[ \frac{1}{m_s ( s^2 + 2 \xi_s \omega_s s + \omega^2_s )} \right] \mathbf{U}_s^* \mathbf{f} 
    - \mathbf{U}_s \text{diag}\left[ \frac{1}{m_s \omega^2_s } \right] \mathbf{U}_s^* \mathbf{f} + \\
  & + \mathbf{U}_s \text{diag}\left[ \frac{1}{m_s \omega^2_s } \right] \mathbf{U}_s^* \mathbf{f}
    + \mathbf{U}_f \text{diag}\left[ \frac{1}{m_f \omega^2_f } \right] \mathbf{U}_f^* \mathbf{f} = \\
  & = \mathbf{U}_s \text{diag}\left[ \frac{-s^2 -2 \xi_s \omega_s s}{m_s \omega^2_s ( s^2 + 2 \xi_s \omega_s s + \omega^2_s )} \right] \mathbf{U}_s^* \mathbf{f} 
    - \mathbf{U} \text{diag}\left[ \frac{1}{m_i \omega^2_i } \right] \mathbf{U}^* \mathbf{f} + \\
  & = \mathbf{U}_s \text{diag}\left[ \frac{-s^2 -2 \xi_s \omega_s s}{m_s \omega^2_s ( s^2 + 2 \xi_s \omega_s s + \omega^2_s )} \right] \mathbf{U}_s^* \mathbf{f}
    - \mathbf{K}^{-1} \mathbf{f} \\
  & = ... \\
  & = - \mathbf{U}_s \left( \mathbf{U}_s^ \mathbf{K} \mathbf{U}_s \right)^{-1} \left(  \right) \text{diag} \left[ \frac{1}{m_s (s^2 + 2 \xi_s \omega_s s + \omega^2_s) } \right] \mathbf{U}_s^* \mathbf{f} -  \mathbf{K}^{-1} \mathbf{f} \ .
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
 & \mathbf{U}_s \text{diag}\left[ \frac{-s^2 -2 \xi_s \omega_s s}{m_s \omega^2_s ( s^2 + 2 \xi_s \omega_s s + \omega^2_s )} \right] \mathbf{U}_s^* \mathbf{f}  = \\
 & = \mathbf{U}_s \text{diag}\left[ \frac{1}{k_s} \right] \text{diag}\left[ m_s ( s^2 + 2  \xi_s \omega_s s ) \right]\text{diag}\left[ \frac{1}{m_s ( s^2 + 2 \xi_s \omega_s s + \omega^2_s) } \right] \mathbf{U}_s^* \mathbf{f} = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
…\sphinxstylestrong{todo}…


\section{With free rigid motion}
\label{\detokenize{ch/solids/small-displacements-numerics:with-free-rigid-motion}}
\sphinxAtStartPar
Free rigid degrees of freedom are associated with vectors of the kernel of the stiffness matrix. The stiffness matrix is singular…

\sphinxstepscope


\chapter{Structural damping}
\label{\detokenize{ch/solids/structural-damping:structural-damping}}\label{\detokenize{ch/solids/structural-damping:solid-mechanics-intro-small-displacements-damping}}\label{\detokenize{ch/solids/structural-damping::doc}}
\sphinxAtStartPar
As a first approximation, a large number of structures can be treated as undamped structures that, if constrained so that there’s no rigid motion allowed, can be represented by the second order system
\begin{equation*}
\begin{split}\mathbf{M} \ddot{\mathbf{x}} + \mathbf{K} \mathbf{x} = \mathbf{f} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
being mass and stiffness matrices \(\mathbf{M}\), \(\mathbf{K}\) that are positive definite, and symmetric if derived as an example from a Lagrangian formulation of the problem.

\sphinxAtStartPar
\sphinxstylestrong{todo} Add reference to Lagrange mechanics and its properties in the classical mechanics bbooks.

\sphinxAtStartPar
This kind of systems are conveniently described using \sphinxstylestrong{modal basis}, as modes (or free/natural modes of vibrations) are orthogonal w.r.t. both mass and stiffness matrix.

\sphinxAtStartPar
\sphinxstylestrong{todo} Add reference; add comment: diagonal, or diagonalizable with coincident eigenvectors.

\sphinxAtStartPar
\sphinxstylestrong{Free response} using modal basis


\section{Small damping}
\label{\detokenize{ch/solids/structural-damping:small-damping}}
\sphinxAtStartPar
Structural small damping can be treated as a first order perturbation of the undamped system,
\begin{equation*}
\begin{split}\mathbf{M} \ddot{\mathbf{u}} + \mathbf{C} \dot{\mathbf{u}} + \mathbf{K} \mathbf{u} = \mathbf{f} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
or in Laplace domain
\begin{equation*}
\begin{split}\left[ s^2 \mathbf{M} + s \mathbf{C} + \mathbf{K} \right] \mathbf{u} = \mathbf{f} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Here two assumptions are made and justified later:
\begin{itemize}
\item {} 
\sphinxAtStartPar
matrix \(\mathbf{C}\) is (semi)positive symmetric

\item {} 
\sphinxAtStartPar
matrix \(\mathbf{C}\) becomes diagonal in the modal basis, i.e. modal basis simoultaneously diagonalize mass, damping and stiffness matrices

\end{itemize}

\sphinxAtStartPar
If these two assumption holds, using the modal base collected in matrix \(\mathbf{U}\),
\begin{equation*}
\begin{split}\mathbf{u} = \mathbf{U} \mathbf{q} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
the diagonalization reads
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{U}^T \mathbf{f}
& = \mathbf{U}^T \left\{ \mathbf{M} \mathbf{U} \ddot{\mathbf{q}} + \mathbf{C} \mathbf{U} \dot{\mathbf{q}} + \mathbf{K} \mathbf{U} \mathbf{q} \right\} = \\
& = \text{diag} \{ m_i \} \ddot{\mathbf{q}} + \text{diag}\{ c_i \} \dot{\mathbf{q}} + \text{diag}\{ k_i \} \mathbf{q} = \\
& = \text{diag} \{ m_i \ddot{q}_i + c_i \dot{q}_i + k_i q_i \} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
being \(m_i := \mathbf{u}_i^T \mathbf{M} \mathbf{u}_i\), \(c_i := \mathbf{u}_i^T \mathbf{C} \mathbf{u}_i\), \(k_i := \mathbf{u}_i^T \mathbf{K} \mathbf{u}_i\), the modal mass, damping and stiffness.
\subsubsection*{(Semi)definite positive damping matrix}

\sphinxAtStartPar
Starting from the equations of motion
\begin{equation*}
\begin{split}\mathbf{M} \ddot{\mathbf{u}} + \mathbf{C} \dot{\mathbf{u}} + \mathbf{K} \mathbf{u} = \mathbf{f} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
the kinetic energy and the mechanical energy balance is derived (\sphinxstylestrong{todo} add references) with scalar multiplication by \(\dot{\mathbf{u}}\). For constant matrices,
\begin{equation*}
\begin{split}\begin{aligned}
 \dot{\mathbf{u}}^T \mathbf{M} \ddot{\mathbf{u}} + \dot{\mathbf{u}}^T \mathbf{C} \dot{\mathbf{u}} + \dot{\mathbf{u}}^T \mathbf{K} \mathbf{u} & = \dot{\mathbf{u}}^T \mathbf{f} \\
 \dfrac{d}{dt} \left[ \dfrac{1}{2} \dot{\mathbf{u}}^T \mathbf{M} \dot{\mathbf{u}} + \dfrac{1}{2} \mathbf{u}^T \mathbf{K} \mathbf{u} \right] & = \dot{\mathbf{u}}^T \mathbf{f} - \dot{\mathbf{u}}^T \mathbf{C} \dot{\mathbf{u}}  \\
 \dfrac{d}{dt} \left( K + V \right) & = \dot{\mathbf{u}}^T \mathbf{f} - \underbrace{\dot{\mathbf{u}}^T \mathbf{C} \dot{\mathbf{u}}}_{ D \ge 0} \ , \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having recognized \(D = \dot{\mathbf{u}}^T \mathbf{C} \dot{\mathbf{u}} \ge 0\) as the dissipation from damping, that can’t make the mechanical energy of the system \(K + V\) increase. This condition implies that \(\mathbf{C}\) is (semi)definite positive.
\subsubsection*{Diagonal damping in modal basis}

\sphinxAtStartPar
Let’s write here the perturbed free damped system in Laplace domain using modal basis,
\begin{equation*}
\begin{split}\left[ s^2 \mathbf{M} + s \mathbf{C} + \mathbf{K} \right] \mathbf{u} = \mathbf{0} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and evaluate the derivative of this relation w.r.t. a parameter \(p\) associated to the damping, and not influencing mass or stiffness properties, \(\mathbf{M}_{/p} = \mathbf{0}\), \(\mathbf{K}_{/p} = \mathbf{0}\),
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{0} 
  & = \left\{ \left[ s^2 \mathbf{M} + s \mathbf{C} + \mathbf{K} \right] \mathbf{u} \right\}_{/p} = \\
  & = \left[ (2 s \mathbf{M} + \mathbf{C} ) s_{/p} + s \mathbf{C}_{/p} \right] \mathbf{u}
    + \left[ s^2 \mathbf{M} + s \mathbf{C} + \mathbf{K} \right] \mathbf{u}_{/p} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Let’s investigate the effect of small damping on the eigensolution \(\left(s_i, \mathbf{u}_i \right)\). Exploiting the symmetry of the matrices of the system (following from the assumed simultaneous diagonalization of the damping matrix \(\mathbf{C} = \mathbf{U} \text{diag}\{ c_i \} \mathbf{U}^*\)), and evaluating the dot product of the latter relation for the \(i\)\sphinxhyphen{}th eigensolution with the eigenvector \(\mathbf{u}_i\),
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = \mathbf{u}_i^T \left\{ \left[ (2 s_i \mathbf{M} + \mathbf{C} ) s_{i/p} + s_i \mathbf{C}_{/p} \right] \mathbf{u}_i
      + \left[ s_i^2 \mathbf{M} + s_i \mathbf{C} + \mathbf{K} \right] \mathbf{u}_{i/p} \right\} = \\
    & = \mathbf{u}_i^T \left[ (2 s_i \mathbf{M} + \mathbf{C} ) s_{i/p} + s_i \mathbf{C}_{/p} \right] \mathbf{u}_i
      + \mathbf{u}_{i/p}^T \underbrace{\left[ s_i^2 \mathbf{M} + s_i \mathbf{C} + \mathbf{K} \right] \mathbf{u}_i}_{=\mathbf{0}} = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
it follows that the derivative of the \(i^{th}\) eigenvalue w.r.t. the parameter \(p\) reads
\begin{equation*}
\begin{split}s_{i/p} = - \dfrac{s_i \mathbf{u}_i^T \mathbf{C}_{/p} \mathbf{u}_i}{\mathbf{u}_i^T (2 s_i \mathbf{M} + \mathbf{C} ) \mathbf{u}_i} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
This derivative evaluated for the reference undamped condition \(\mathbf{C} = \mathbf{0}\) becomes
\begin{equation*}
\begin{split}s_{i/p} = - \dfrac{1}{2} \dfrac{\mathbf{u}_i^T \mathbf{C}_{/p} \mathbf{u}_i}{\mathbf{u}_i^T \mathbf{M} \mathbf{u}_i} = - \dfrac{1}{2} \dfrac{\mathbf{u}_i^T \mathbf{C}_{/p} \mathbf{u}_i}{m_i} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
having recognized the modal mass \(m_i := \mathbf{u}_i^T \mathbf{M} \mathbf{u}_i\) associated to the \(i^{th}\) mode. Now, let’s evaluate the derivative of the eigenvalue \(s_i\) w.r.t. the components of the damping matrix \(\mathbf{C}\), i.e. \(\mathbf{C}_{/C_{jk}}\) that is a matrix full of zero, except for the component \((j,k)\) equal to one,
\begin{equation*}
\begin{split}s_{i/C_{jk}} = - \dfrac{1}{2} \dfrac{\mathbf{u}_i^T \mathbf{C}_{/C_{jk}} \mathbf{u}_i}{m_i} = -\dfrac{1}{2} \dfrac{u^{(i)}_j u^{(i)}_k}{m_i} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the first order polynomial expansion of \(s_i\) in coefficients \(C_{jk}\) reads
\begin{equation*}
\begin{split}\begin{aligned}
  s_i & = s_{i,0} + s_{i/C_{jk}} C_{jk} = \\
      & = s_{i,0} - \dfrac{1}{2} \dfrac{u^{(i)}_j C_{jk} u^{(i)}_k}{m_i} = \\
      & = s_{i,0} - \dfrac{1}{2} \dfrac{\mathbf{u}_i^T \mathbf{C} \mathbf{u}_i}{m_i}
\ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
From this expression, it’s possible to deduce that the \(i^{th}\) eigenvalue of the slightly damped system differs from the \(i^{th}\) eigenvalue of the undamped system \(s_{i,0} = \mp j \omega_{i}\) of a real non\sphinxhyphen{}positive (as \(\mathbf{C} \ge 0\) for dissipative damping actions) term \(\Delta s_i = - \frac{1}{2} \frac{\mathbf{u}_i^T \mathbf{C} \mathbf{u}_i}{m_i} \in \mathbb{R}\), \(\Delta s_i \le 0\), depending only on the damping matrix and the \(i^{th}\) mode. This term shifts the eigenvalue \(s_i\) to the left in the complex plane, and thus makes it asymptotically stable.

\sphinxAtStartPar
As the variation \(\Delta s_i\) only depends on the \(i^{th}\) eigenvector, and not on other eigenvectors, the assumption of siultaneously diagonalizable damping matrix is consistent with the results from this assumption.

\sphinxstepscope


\part{Fluid Mechanics}

\sphinxstepscope


\chapter{Introduction to Fluid Mechanics}
\label{\detokenize{ch/fluids/intro:introduction-to-fluid-mechanics}}\label{\detokenize{ch/fluids/intro:fluid-mechanics-intro}}\label{\detokenize{ch/fluids/intro::doc}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Statics and definition of fluids, as medium that has no shear stress at rest.

\item {} 
\sphinxAtStartPar
Kinematics

\item {} 
\sphinxAtStartPar
Dynamics

\item {} 
\sphinxAtStartPar
Models:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Incompressible flows
\begin{itemize}
\item {} 
\sphinxAtStartPar
Governing equations, theorems and regimes of motion
\begin{itemize}
\item {} 
\sphinxAtStartPar
Inviscid

\item {} 
\sphinxAtStartPar
Irrotational

\end{itemize}

\end{itemize}

\item {} 
\sphinxAtStartPar
Compressible flows
\begin{itemize}
\item {} 
\sphinxAtStartPar
Inviscid

\item {} 
\sphinxAtStartPar
…

\end{itemize}

\end{itemize}

\end{itemize}

\sphinxstepscope


\chapter{Statics}
\label{\detokenize{ch/fluids/statics:statics}}\label{\detokenize{ch/fluids/statics:fluid-mechanics-statics}}\label{\detokenize{ch/fluids/statics::doc}}
\sphinxAtStartPar
The behavior of continuous medium in static conditions can be used to define a fluid.
\label{ch/fluids/statics:definition-0}
\begin{sphinxadmonition}{note}{Definition 11.1 (Fluid)}



\sphinxAtStartPar
A fluid can be defined as a continuous medium with no shear stress in static conditions. Thus, the stress tensor of an \sphinxstyleemphasis{isotropic fluid} under static conditions reads
\begin{equation*}
\begin{split}\mathbb{T}^s = - p \mathbb{I} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
where \(p\) is \sphinxstyleemphasis{pressure}. (\sphinxstylestrong{todo} mechanical? Thermodynamical?)
\end{sphinxadmonition}

\sphinxstepscope


\chapter{Constitutive Equations of Fluid Mechanics}
\label{\detokenize{ch/fluids/constitutive-equations:constitutive-equations-of-fluid-mechanics}}\label{\detokenize{ch/fluids/constitutive-equations:fluid-mechanics-constutive-equations}}\label{\detokenize{ch/fluids/constitutive-equations::doc}}

\section{Newtonian Fluids}
\label{\detokenize{ch/fluids/constitutive-equations:newtonian-fluids}}\label{\detokenize{ch/fluids/constitutive-equations:fluid-mechanics-constutive-equations-newtonian}}
\sphinxAtStartPar
A Newtonian fluid is the model of a fluid as a continuous medium whose stress tensor can be written as the sum of the hydrostatic pressure stress tensor \(-p \mathbb{I}\) \sphinxhyphen{} the only contribution holding in {\hyperref[\detokenize{ch/fluids/statics:fluid-mechanics-statics}]{\sphinxcrossref{\DUrole{std,std-ref}{statics}}}} \sphinxhyphen{} and a viscous stress tensor \(\mathbb{S}\)
\begin{equation*}
\begin{split}\mathbb{T} = -p \mathbb{I} + \mathbb{S} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the viscous stress tensor is isotropic and \sphinxstylestrong{linear} in the first\sphinxhyphen{}order spatial derivatives of the velocity field,
\begin{equation}\label{equation:ch/fluids/constitutive-equations:eq:stress-viscous}
\begin{split}\mathbb{S} = 2 \mu \mathbb{D} + \lambda (\nabla \cdot \vec{u}) \mathbb{I} \ ,\end{split}
\end{equation}
\sphinxAtStartPar
being \(\mu, \lambda\) the viscosity coefficients, and \(\mathbb{D}\) the strain velocity tensor \eqref{equation:ch/continuum/kinematics:eq:strain-vel-tensor}. Thus, the definition
\label{ch/fluids/constitutive-equations:definition-0}
\begin{sphinxadmonition}{note}{Definition 12.1.1 (Newtonian fluid)}



\sphinxAtStartPar
A Newtonian fluid is a continuous medium whose stress tensor reads
\begin{equation}\label{equation:ch/fluids/constitutive-equations:eq:stress-newtonian}
\begin{split}\mathbb{T} = - p \mathbb{I} + 2 \mu \mathbb{D} + \lambda (\nabla \cdot \vec{u}) \mathbb{I} \ .\end{split}
\end{equation}\end{sphinxadmonition}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The expression \eqref{equation:ch/fluids/constitutive-equations:eq:stress-viscous} of the viscosity stress tensor is the most general expression of a 2\sphinxhyphen{}nd order symmetric isotropic tensor proportional to 1\sphinxhyphen{}st order derivatives of a vector field.
\end{sphinxadmonition}

\sphinxstepscope


\chapter{Governing Equations of Fluid Mechanics}
\label{\detokenize{ch/fluids/governing-equations:governing-equations-of-fluid-mechanics}}\label{\detokenize{ch/fluids/governing-equations:fluid-mechanics-governing-equations}}\label{\detokenize{ch/fluids/governing-equations::doc}}

\section{Newtonian Fluid}
\label{\detokenize{ch/fluids/governing-equations:newtonian-fluid}}
\sphinxAtStartPar
The differential conservative form of the governing equations of a {\hyperref[\detokenize{ch/fluids/constitutive-equations:fluid-mechanics-constutive-equations-newtonian}]{\sphinxcrossref{\DUrole{std,std-ref}{Newtonian fluid}}}} directly follows from the expression \eqref{equation:ch/continuum/balance-primary-differential:eq:continuum:primary:differential:conservative} of {\hyperref[\detokenize{ch/continuum/balance-primary-integral:continuum-governing-equations-primary-integral}]{\sphinxcrossref{\DUrole{std,std-ref}{governing equations of a continuum medium in differential form}}}},
\begin{equation*}
\begin{split}\begin{cases}
  \dfrac{\partial \rho }{\partial t} + \nabla \cdot \left( \rho \vec{v} \right) = 0 \\
  \dfrac{\partial }{\partial t} \left( \rho \vec{v} \right) +  \nabla \cdot \left( \rho \vec{v} \otimes \vec{v} \right) = \rho \vec{g} + \nabla \cdot \mathbb{T} \\
  \dfrac{\partial}{\partial t}  \left( \rho e^t \right) + \nabla \cdot \left( \rho e^t \vec{v} \right) = \rho \vec{g} \cdot \vec{v} + \nabla \cdot \left( \mathbb{T} \cdot \vec{v} \right) - \nabla \cdot \vec{q} + \rho r
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
using the expression \eqref{equation:ch/fluids/constitutive-equations:eq:stress-newtonian} of the stress tensor of a Newtonian fluid,
\begin{equation*}
\begin{split}\mathbb{T} = - p \mathbb{I} + 2 \mu \mathbb{D} + \lambda (\nabla \cdot \vec{v}) \mathbb{I} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
a constitutive equation for conduction heat flux \(\vec{q}\), as an example \sphinxstylestrong{Fourier’s law}
\begin{equation*}
\begin{split}\vec{q} = - k \nabla T \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the required state equations characterizing the behavior of the medium linking thermodynamic variables (assumption of \sphinxstylestrong{local thermodynamic equilibrium} \sphinxstylestrong{todo} \sphinxstyleemphasis{discuss this principle}), and required to get a well\sphinxhyphen{}defined mathematical problem, with the same number of equations and unknowns.
\label{ch/fluids/governing-equations:example-0}
\begin{sphinxadmonition}{note}{Example 13.1.1 (Equations of state)}



\sphinxAtStartPar
As an example, the required equations of states need to provide and expression of thermodynamic quantities as a function of the dynamical physical quantities. This could be quite a common choice in numerical methods using conservative form of the equations. Namely, defining momentum and total energy per unit volume
\begin{equation*}
\begin{split}\vec{m} := \rho \vec{v} \quad , \quad E^t := \rho e^t \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
equations of state should provide the expression of pressure \(p\), temperature \(T\), viscosity coefficients \(\mu\), \(\nu\) and thermal conductivity \(k\) as functions of “dynamic quantities” \(\rho, \, \vec{m}, \, E^t\),
\begin{equation*}
\begin{split}\begin{aligned}
        p & (\rho, \vec{m}, E^t) \\
        T & (\rho, \vec{m}, E^t) \\
      \mu & (\rho, \vec{m}, E^t) \\
  \lambda & (\rho, \vec{m}, E^t) \\
        k & (\rho, \vec{m}, E^t) \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Usually, in thermodynamics pressure and temperature can be written as functions of other two thermodynamic variables, as an example density \(\rho\) and internal energy (per unit mass)
\begin{equation*}
\begin{split}e = e^t - \frac{|\vec{v}|^2}{2} = \frac{E^t}{\rho} - \frac{1}{2}\frac{|\vec{m}|^2}{\rho^2}\end{split}
\end{equation*}
\sphinxAtStartPar
so that \sphinxhyphen{} avoiding here notation abuses and using two different symbols for functions with different independent variables representing the same physical quantity \sphinxhyphen{},
\begin{equation*}
\begin{split}\begin{aligned}
  \Pi   \left( \rho, e \right) & = \Pi   \left( \rho, \frac{E^t}{\rho} - \frac{1}{2}\frac{|\vec{m}|^2}{\rho^2} \right) = p(\rho, \vec{m}, E^t) \\
  \Theta\left( \rho, e \right) & = \Theta\left( \rho, \frac{E^t}{\rho} - \frac{1}{2}\frac{|\vec{m}|^2}{\rho^2} \right) = T(\rho, \vec{m}, E^t) \\
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}


\section{Derived quantities}
\label{\detokenize{ch/fluids/governing-equations:derived-quantities}}
\sphinxAtStartPar
Balance equations of kinetic energy and internal energy readily follows from balance equations of continuum media in covective form.



\sphinxAtStartPar
\sphinxstylestrong{Kinetic energy.}

\sphinxAtStartPar
\sphinxstylestrong{Internal energy.}
\begin{equation*}
\begin{split}\begin{aligned}
 \rho \frac{D e}{D t}
  & = \mathbb{T} : \nabla \vec{v} - \nabla \cdot \vec{q} + \rho r  = \\
  & = \left( -p \mathbb{I} + 2 \mu \mathbb{D} + \lambda (\nabla \cdot \vec{v}) \mathbb{I} \right) : \nabla \vec{v} - \nabla \cdot \vec{q} + \rho r  = \\
  & = - p \nabla \cdot \vec{v} + 2 \mu \mathbb{D} : \mathbb{D} + \lambda (\nabla \cdot \vec{v})^2 - \nabla \cdot \vec{q} + \rho r
\end{aligned}\end{split}
\end{equation*}\subsubsection*{Details}

\sphinxAtStartPar
\sphinxstylestrong{todo}

\sphinxAtStartPar
\sphinxstylestrong{Entropy equation.} The first principle of thermodynamics for non\sphinxhyphen{}reactive fluid, with no electric charge and other processes, provides the expression of the differential of entropy as a function of internal energy and density, \(s(e, \rho)\)
\begin{equation*}
\begin{split}d e = T \, ds + \frac{P}{\rho^2} d \rho  \qquad , \qquad ds = \dfrac{1}{T} \, de - \frac{P}{T \rho^2} \, d \rho \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and thus the balance equation for entropy directly follows from the evaluation of the material derivative of entropy field, exploiting balance equations of mass and internal energy
\begin{equation*}
\begin{split}\begin{aligned}
  \rho \frac{D s}{D t}
  & = \frac{1}{T} \left[ \rho \frac{D e}{D t} - \frac{P}{\rho} \dfrac{D \rho}{D t} \right] = \\
  & = \frac{1}{T} \left[ - p \nabla \cdot \vec{v} + 2 \mu \mathbb{D} : \mathbb{D} + \lambda (\nabla \cdot \vec{v})^2 - \nabla \cdot \vec{q} + \rho r - \frac{P}{\rho} \left( - \rho \nabla \cdot \vec{v} \right) \right] = \\
  & = \frac{1}{T} \left[ 2 \mu \mathbb{D} : \mathbb{D} + \lambda (\nabla \cdot \vec{v})^2 - \nabla \cdot \vec{q} + \rho r \right] = \\
  & = \frac{ 2 \mu \mathbb{D} : \mathbb{D} + \lambda (\nabla \cdot \vec{v})^2}{T} - \frac{\vec{q} \cdot \nabla T}{T^2} - \nabla \cdot \left( \frac{\vec{q}}{T} \right) + \frac{\rho r}{T} = \\
  & = \frac{ 2 \mu \mathbb{D} : \mathbb{D} + \lambda (\nabla \cdot \vec{v})^2}{T} + \frac{k |\nabla T|^2}{T^2} - \nabla \cdot \left( \frac{\vec{q}}{T} \right) + \frac{\rho r}{T} \ .
\end{aligned}\end{split}
\end{equation*}\subsubsection*{Details}
\begin{equation*}
\begin{split}\nabla \cdot \left( \frac{\vec{q}}{T} \right) = \frac{\nabla \cdot \vec{q}}{T} - \frac{\vec{q} \cdot \nabla T}{T^2}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Second principle of thermodyanamics and continuum mechanics.} Second principle of thermodynamics implies some constraints on the behavior of continuous media, and thus on the contitutive equations. Namely, Clausis statement of the second principle reads
\begin{equation*}
\begin{split}d S \ge \frac{\delta Q}{T} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
i.e. the variation of entropy is greater or equal to the ratio of the heat flux added to the system and the temperature of the system itself. This can be written for a simple homogeneous system, or for a composite systems where physical quantities are not homogeneous in space \sphinxstylestrong{todo} ref

\sphinxAtStartPar
Integral form of balance equation of entropy of a system reads
\begin{equation*}
\begin{split}\frac{d S}{dt} = \frac{d}{dt} \int_{V_t} \rho s = \int_{V_t} \left\{ \frac{ 2 \mu \mathbb{D} : \mathbb{D} + \lambda (\nabla \cdot \vec{v})^2}{T} + \frac{k |\nabla T|^2}{T^2} \right\} \underbrace{- \oint_{\partial V_t} \frac{\vec{q}}{T} \cdot \hat{n} + \int_{V_t} \frac{\rho r}{T}}_{"\frac{\delta Q}{T}"} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and Clausius statement of the second principle implies
\begin{equation*}
\begin{split}0 \le \frac{d}{dt} \int_{V_t} \rho s - \left( - \oint_{\partial V_t} \frac{\vec{q}}{T} \cdot \hat{n} + \int_{V_t} \frac{\rho r}{T} \right) = \int_{V_t} \left\{ \frac{ 2 \mu \mathbb{D} : \mathbb{D} + \lambda (\nabla \cdot \vec{v})^2}{T} + \frac{k |\nabla T|^2}{T^2} \right\} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and, since this must hold for any volume \(V_t\) and state of the system \sphinxhyphen{} namley every velocity and temperature field \sphinxhyphen{} and thermodynamic temperature is positive, it follows that
\begin{equation*}
\begin{split}\mu \ge 0 \quad , \quad \lambda \ge 0 \quad , \quad k \ge 0\end{split}
\end{equation*}\label{ch/fluids/governing-equations:example-1}
\begin{sphinxadmonition}{note}{Example 13.2.1 (Sign of physical quantity)}



\sphinxAtStartPar
\sphinxstylestrong{todo} pay attention, that temperature, viscosity ccoefficients and thermal conductivity have physical dimensions…explain the meaning of positive physical quantities (scalar, w.r.t. a unit of measurement)…
\end{sphinxadmonition}

\sphinxstepscope


\chapter{Non\sphinxhyphen{}dimensional Equations of Fluid Mechanics}
\label{\detokenize{ch/fluids/dimensional-analysis:non-dimensional-equations-of-fluid-mechanics}}\label{\detokenize{ch/fluids/dimensional-analysis:fluid-mechanics-dimensional-analysis}}\label{\detokenize{ch/fluids/dimensional-analysis::doc}}
\sphinxAtStartPar
If \(\rho(P, s)\),
\begin{equation*}
\begin{split}d \rho = \left(\frac{\partial \rho}{\partial P}\right)_s \, d P + \left(\dfrac{\partial \rho}{\partial s} \right)_{\rho} \, ds\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{cases}
  \dfrac{D \rho}{D t} + \rho \nabla \cdot \vec{v} = 0  \\
  \rho \dfrac{D \vec{v}}{D t} = \rho \vec{g} + \nabla \cdot \left(-p \mathbb{I} + 2 \mu \mathbb{D} + \lambda (\nabla \cdot \vec{v}) \mathbb{I} \right)  \\
  \rho \dfrac{D e^t    }{D t} = \rho \vec{g} \cdot \vec{v} + \nabla \cdot \left( \mathbb{T} \cdot \vec{v} \right) - \nabla \cdot \vec{q} + \rho r \\
\end{cases}\end{split}
\end{equation*}
\sphinxstepscope


\chapter{Incompressible Fluid Mechanics}
\label{\detokenize{ch/fluids/incompressible:incompressible-fluid-mechanics}}\label{\detokenize{ch/fluids/incompressible:fluid-mechanics-incompressible}}\label{\detokenize{ch/fluids/incompressible::doc}}
\sphinxAtStartPar
Chapter of a introductory course in incompressible fluid mechanics:
\begin{itemize}
\item {} 
\sphinxAtStartPar
statics

\item {} 
\sphinxAtStartPar
kinematics

\item {} 
\sphinxAtStartPar
governing equations

\item {} 
\sphinxAtStartPar
non\sphinxhyphen{}dimensional equations

\item {} 
\sphinxAtStartPar
vorticity dynamics

\item {} 
\sphinxAtStartPar
low\sphinxhyphen{}\(Re\) exact solutions

\item {} 
\sphinxAtStartPar
high\sphinxhyphen{}\(Re\) flows, incompressible inviscid irrotational flows:
\begin{itemize}
\item {} 
\sphinxAtStartPar
vorticity dynamics and Bernoulli theorems

\item {} 
\sphinxAtStartPar
aeronautical applications

\end{itemize}

\item {} 
\sphinxAtStartPar
boundary layer

\item {} 
\sphinxAtStartPar
instability and turbulence

\end{itemize}


\section{Navier\sphinxhyphen{}Stokes Equations}
\label{\detokenize{ch/fluids/incompressible:navier-stokes-equations}}\label{\detokenize{ch/fluids/incompressible:fluid-mechanics-incompressible-ns-eqn}}
\sphinxAtStartPar
The kinematic constraints (link to {\hyperref[\detokenize{ch/fluids/dimensional-analysis:fluid-mechanics-dimensional-analysis}]{\sphinxcrossref{\DUrole{std,std-ref}{Non\sphinxhyphen{}dimensional Equations of Fluid Mechanics}}}}?)
\begin{equation*}
\begin{split}\nabla \cdot \vec{v} = 0\end{split}
\end{equation*}
\sphinxAtStartPar
replaces mass balance in the governing equation and implies \(\frac{D \rho}{D t} = 0\), i.e. all the material particles have constant density in time.

\sphinxAtStartPar
If …
\begin{equation}\label{equation:ch/fluids/incompressible:eq:ns-eqn}
\begin{split}\begin{cases}
\rho \left[ \frac{\partial \vec{u}}{\partial t} + \vec{u} \cdot \nabla ) \vec{u} \right] - \mu \nabla^2 \vec{u} + \nabla P = \rho \vec{g} \\
\nabla \cdot \vec{u} = 0
\end{cases}\end{split}
\end{equation}
\sphinxAtStartPar
with the proper initial conditions, boundary conditions and \sphinxhyphen{} if required \sphinxhyphen{} {\hyperref[\detokenize{ch/fluids/incompressible:fluid-mechanics-incompressible-compatibility}]{\sphinxcrossref{\DUrole{std,std-ref}{compatibility conditions}}}}.

\phantomsection\label{\detokenize{ch/fluids/incompressible:fluid-mechanics-incompressible-compatibility}}\subsubsection*{Compatibility condition}

\sphinxAtStartPar
A compatibility condition is needed if the velocity field is prescribed on the whole boundary \(\partial V\) of the domain \(V\),
\begin{equation*}
\begin{split}\vec{u}\bigg|_{\partial V} = \vec{b}_n \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The compatibility condition reads
\begin{equation*}
\begin{split}\oint_{\partial V} \vec{b}  \cdot \hat{n} = 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
to ensure that the conudary conditions are consistent with the incompressibility constraint, as it is readily proved using divergence theorem on the velocity field in \(V\),
\begin{equation*}
\begin{split}0 \equiv \int_V \underbrace{\nabla \cdot \vec{u}}_{= 0} = \oint_{\partial V} \hat{v} \cdot \hat{n} = \oint_{\partial V} \vec{b} \cdot \hat{n} \ .\end{split}
\end{equation*}

\section{Vorticity}
\label{\detokenize{ch/fluids/incompressible:vorticity}}\label{\detokenize{ch/fluids/incompressible:fluid-mechanics-incompressible-vorticity}}
\sphinxAtStartPar
A dynamical equation for vorticity \(\vec{\omega} := \nabla \times \vec{u}\) reailty follows taking the curl of Navier\sphinxhyphen{}Stokes equations \eqref{equation:ch/fluids/incompressible:eq:ns-eqn}
\begin{equation}\label{equation:ch/fluids/incompressible:eq:vorticity}
\begin{split}\frac{D \vec{\omega}}{D t} = (\vec{\omega} \cdot \nabla) \vec{u} + \nu \Delta \vec{\omega} \ ,\end{split}
\end{equation}
\sphinxAtStartPar
i.e. vorticity can be stretched\sphinxhyphen{}tilted by the term \((\vec{\omega} \cdot \nabla) \vec{u}\), or diffused by the term \(\nu \Delta \vec{\omega}\).

\sphinxAtStartPar
…


\section{Bernoulli theorems}
\label{\detokenize{ch/fluids/incompressible:bernoulli-theorems}}\label{\detokenize{ch/fluids/incompressible:id1}}
\sphinxAtStartPar
For an incompressible fluid, the advective term \((\vec{u} \cdot \nabla) \cdot \vec{u}\) can be recasted as
\begin{equation*}
\begin{split}(\vec{u} \cdot \nabla) \cdot \vec{u} = \vec{\omega} \times \vec{u} + \nabla \frac{|\vec{u}|^2}{2} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
so that the momentum equation in Navier\sphinxhyphen{}Stokes equations \eqref{equation:ch/fluids/incompressible:eq:ns-eqn} for fluids with uniform density \(\rho\) reads
\begin{equation}\label{equation:ch/fluids/incompressible:eq:ns-mom-bernoulli}
\begin{split} \rho \left[ \frac{\partial \vec{u}}{\partial t} + \vec{\omega} \times \vec{u} + \nabla \frac{|\vec{u}|^2}{2} \right] - \mu \Delta \vec{u} + \nabla P = \rho \vec{g} \ .\end{split}
\end{equation}
\sphinxAtStartPar
Starting from the form \eqref{equation:ch/fluids/incompressible:eq:ns-mom-bernoulli}, different forms of Bernoulli theorems are readilty derived with the proper assumptions.
\label{ch/fluids/incompressible:theorem-0}
\begin{sphinxadmonition}{note}{Theorem 15.3.1 (Bernoulli theorem along path and vortex lines in steady flows)}



\sphinxAtStartPar
In a steady incompressible inviscid flow with conservative volume forces, \(\vec{g} = - \nabla \chi\), the Bernoulli polynomial is constant along path (everywhere tangent to the velocity field, \(\hat{t}(\vec{r}) \parallel \vec{u}(\vec{r})\)) and vortex lines (everywhere tangent to the vorticity field, \(\hat{t}(\vec{r}) \parallel \vec{\omega}(\vec{r})\)), i.e. the directional derivative of the Bernoulli polynomial in the direction of the velocity or the vorticity field is identically zero,
\begin{equation*}
\begin{split}\hat{t} \cdot \nabla \left( \frac{|\vec{u}|^2}{2} + \frac{P}{\rho} + \chi \right) = 0 \ .\end{split}
\end{equation*}\end{sphinxadmonition}

\sphinxAtStartPar
The proof readily follows taking the scalar product with a unit\sphinxhyphen{}norm vector \(\hat{t}\) parallel to the local velocity or vorticity, and noting that \(\hat{t} \cdot \vec{u} \times \vec{\omega}\) is zero if either \(\hat{t} \parallel \vec{v}\) or \(\hat{t} \parallel \vec{\omega}\).
\label{ch/fluids/incompressible:theorem-1}
\begin{sphinxadmonition}{note}{Theorem 15.3.2 (Bernoulli theorem in irrotational inviscid steady flows)}



\sphinxAtStartPar
In a steady incompressible inviscid irrotational flow with conservative volume forces, \(\vec{g} = - \nabla \chi\), the Bernoulli polynomial is uniform in the whole domain, since its gradient is identically zero
\begin{equation*}
\begin{split}\nabla \left( \frac{|\vec{u}|^2}{2} + \frac{P}{\rho} + \chi \right) = 0 
\qquad \rightarrow \qquad \frac{|\vec{u}|^2}{2} + \frac{P}{\rho} + \chi = 0 \ .\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/fluids/incompressible:theorem-2}
\begin{sphinxadmonition}{note}{Theorem 15.3.3 (Bernoulli theorem in irrotational inviscid flows)}



\sphinxAtStartPar
In an incompressible inviscid irrotational flow with conservative volume forces, \(\vec{g} = - \nabla \chi\), the Bernoulli polynomial is uniform in the connected irrotational regions of the domain \sphinxhyphen{} but not constant in time in general \sphinxhyphen{} , since its gradient is identically zero
\begin{equation*}
\begin{split}\nabla \left( \frac{\partial \phi}{\partial t} + \frac{|\vec{u}|^2}{2} + \frac{P}{\rho} + \chi \right) = 0 
\qquad \rightarrow \qquad \frac{\partial \phi}{\partial t} + \frac{|\vec{u}|^2}{2} + \frac{P}{\rho} + \chi = C(t) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
being \(\phi\) the velocity potential used to write the irrotational velocity field as the gradient of a scalar function \(\vec{u} = \nabla \phi\).
\end{sphinxadmonition}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The assumption of inviscid flow is not directly required if irrotationality holds. Anyway the inviscid flow assumption may be required to make irrotationality condition holds. Lookinig at the vorticity equation \eqref{equation:ch/fluids/incompressible:eq:vorticity} the assumption of negligible viscosity prevents diffusion of vorticity from rotational regions to irrotational regions.
\end{sphinxadmonition}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
A barotropic fluid is defined as a fluid where the pressure is a function of density only, \(P(\rho)\). For this kind of flows it’s possible to find a function \(\Pi\) so that
\begin{equation*}
\begin{split}d \Pi = \frac{d P}{\rho} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The results of this section derived for a uniform density flow hold for a barotropic fluid as well, replacing \(\frac{P}{\rho}\) with \(\Pi\).
\end{sphinxadmonition}

\sphinxstepscope


\chapter{Compressible Fluid Mechanics}
\label{\detokenize{ch/fluids/compressible:compressible-fluid-mechanics}}\label{\detokenize{ch/fluids/compressible:fluid-mechanics-compressible}}\label{\detokenize{ch/fluids/compressible::doc}}

\section{Compressible Inviscid Fluid Mechanics}
\label{\detokenize{ch/fluids/compressible:compressible-inviscid-fluid-mechanics}}\label{\detokenize{ch/fluids/compressible:fluid-mechanics-compressible-inviscid}}

\subsection{Shocks}
\label{\detokenize{ch/fluids/compressible:shocks}}\label{\detokenize{ch/fluids/compressible:fluid-mechanics-compressible-inviscid-shocks}}

\subsection{Quasi\sphinxhyphen{}1d flows}
\label{\detokenize{ch/fluids/compressible:quasi-1d-flows}}\label{\detokenize{ch/fluids/compressible:fluid-mechanics-compressible-inviscid-quasi-1d}}
\sphinxAtStartPar
If no shock occurs in the flow, Euler equations in differential form governs the dynamics of the flow
\begin{equation*}
\begin{split}\begin{cases}
  \partial_t \rho + \nabla \cdot (\rho \vec{u}) = 0 \\
  \partial_t \left( \rho \vec{u} \right) + \nabla \cdot (\rho \vec{u} \otimes \vec{u} + P \mathbb{I}) = 0 \\
  \partial_t \left( \rho e^t \right) + \nabla \cdot (\rho \vec{u} h^t) = 0 \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Quasi\sphinxhyphen{}1d model for steady flows is a simple model that provides good\sphinxhyphen{}enough results for flows delimited by streamlines that varies gently in the streamwise direction (or by solid walls, in the limit of the high\sphinxhyphen{}Reynolds flow without separations, where viscous effects are confined to a thin region \sphinxhyphen{} boundary layer \sphinxhyphen{} close to the walls).

\sphinxAtStartPar
This model is derived integrating over the sections of the stream tube, so that the physical quantities are functions of the streamwise coordinate \(x\) only. Integration over an elementary volume between sections at \(x\) and \(x+dx\) of the mass and momentum equations, in steady conditions, gives
\begin{equation*}
\begin{split}\begin{cases}
  d (\rho u A) = 0 \\
  d (\rho u^2 A) + d (P A) + \displaystyle\int_{S_{lat}(x,dx)} P n_x = 0 \ ,
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
where the last equation comes from the contribution of the lateral surfaces, that has non zero contribution in the streamwise component of momentum equation if sections is not constant, and thus the unit normal vector \(\hat{n}\) on the lateral surface has non\sphinxhyphen{}zero \(x\)\sphinxhyphen{}component \(n_x\). This contribution on the elementary lateral surface (where pressure is assumed to be uniform), can be evaluated summing and subracting the contributions on the \(A(x)\) and \(A(x+dx)\) surface,
\begin{equation*}
\begin{split}\underbrace{\displaystyle\int_{S_{lat}(x,dx)} P n_x + P (A+dA) - P A}_{ = P \oint_{\partial V} n_x = 0 } - P(A+dA) + PA =  - P dA \end{split}
\end{equation*}
\sphinxAtStartPar
Thus the equations become
\begin{equation*}
\begin{split}\begin{cases}
  0 = d (\rho u A) = 0 \\
  0 = d (\rho u^2 A) + A dP = \rho u A \, du + A \, dP \ ,
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
having used the mass equation to simplify the first term in the momentum equation, since
\begin{equation*}
\begin{split}d(\rho u^2 A) = \underbrace{d(\rho u A)}_{=0} u + \rho u A \, du \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Now, from momentum equation a relation from changes in velocity and pressure holds
\begin{equation*}
\begin{split}\rho u \, du = - dP \ .\end{split}
\end{equation*}
\sphinxAtStartPar
If the flow is isentropic (i.e. negligible viscous effects, no heat conduction, no shocks), \(s = \overline{s}\), the definition of the speed of sound
\begin{equation*}
\begin{split}c^2(\rho, s) = \left( \frac{\partial P}{\partial \rho} \right)_s \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
can be used to write a relation between changes in pressure and density \(d P = c^2 d \rho\). Using this formula and mass equation \(d(\rho u A) = 0\), it’s possible to write relations between physical quantities and the variation of the section of the stream tube. Mass equation can be recast as
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = \dfrac{dA}{A} + \dfrac{d \rho}{\rho} + \dfrac{d u}{u} = \\
    & = \dfrac{dA}{A} + \frac{1}{c^2} \dfrac{d P}{\rho} + \dfrac{d u}{u} = \\
    & = \dfrac{dA}{A} + \frac{1}{c^2} \dfrac{d P}{\rho} - \dfrac{d P}{\rho u^2} 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus, introducing Mach number \(M := \dfrac{u}{c}\),
\begin{equation*}
\begin{split}\dfrac{d A}{A} = (1 - M^2)\dfrac{dP}{\rho u^2} = -(1 - M^2)\dfrac{du}{u} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
From this equation, it’s immediate to realize that:
\begin{itemize}
\item {} 
\sphinxAtStartPar
for subsonic flows \(M<1\), if section of the stream tube increases, \(dA > 0\), thus velocity descreases \(du < 0\), and pressure increases \(dP > 0\), and viceversa

\item {} 
\sphinxAtStartPar
for supersonic flows \(M>1\), if section of the stream tube increases, \(dA > 0\), thus velocity increases \(du > 0\), and pressure decreases \(dP < 0\)

\end{itemize}






\renewcommand{\indexname}{Proof Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{definition\sphinxhyphen{}0}
\item\relax\sphinxstyleindexentry{definition\sphinxhyphen{}0}\sphinxstyleindexextra{ch/fluids/statics}\sphinxstyleindexpageref{ch/fluids/statics:\detokenize{definition-0}}
\indexspace
\bigletter{example\sphinxhyphen{}0}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}0}\sphinxstyleindexextra{ch/fluids/governing\sphinxhyphen{}equations}\sphinxstyleindexpageref{ch/fluids/governing-equations:\detokenize{example-0}}
\indexspace
\bigletter{example\sphinxhyphen{}1}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}1}\sphinxstyleindexextra{ch/fluids/governing\sphinxhyphen{}equations}\sphinxstyleindexpageref{ch/fluids/governing-equations:\detokenize{example-1}}
\indexspace
\bigletter{theorem\sphinxhyphen{}0}
\item\relax\sphinxstyleindexentry{theorem\sphinxhyphen{}0}\sphinxstyleindexextra{ch/fluids/incompressible}\sphinxstyleindexpageref{ch/fluids/incompressible:\detokenize{theorem-0}}
\indexspace
\bigletter{theorem\sphinxhyphen{}1}
\item\relax\sphinxstyleindexentry{theorem\sphinxhyphen{}1}\sphinxstyleindexextra{ch/fluids/incompressible}\sphinxstyleindexpageref{ch/fluids/incompressible:\detokenize{theorem-1}}
\indexspace
\bigletter{theorem\sphinxhyphen{}2}
\item\relax\sphinxstyleindexentry{theorem\sphinxhyphen{}2}\sphinxstyleindexextra{ch/fluids/incompressible}\sphinxstyleindexpageref{ch/fluids/incompressible:\detokenize{theorem-2}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}